<!-- image -->

## M ө c l ө c

| Bài 1                                                           | ĐĔ NG NH Ұ PH ӊ TH Ӕ NGLINUX...............................................                                   | 3                                                                                                        |
|-----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| 1.1.                                                            | Truy c ậ p vào máy tính đ ã cài đặ t h ệ đ i ề u hành Linux.................................                  | 3                                                                                                        |
| 1.2.                                                            | S ử d ụ ng Telnet để truy c ậ p vào máy Linux t ừ xa........................................                  | 3                                                                                                        |
| 1.3.                                                            | Thoát kh ỏ i h ệ th ố ng..................................................................................... | 3                                                                                                        |
| Bài 2                                                           | S Ӱ D Ө NG E-Mail 4                                                                                           |                                                                                                          |
| 2.1.                                                            | G ở i th ư b ằ ng sendmail.................................................................................   | 4                                                                                                        |
| 2.2.                                                            | Nh ậ n th ư                                                                                                   | ...................................................................................................... 4 |
| 2.3.                                                            | Các thao tác h ỗ tr ợ ....................................................................................... | 4                                                                                                        |
| Bài 3                                                           | CÁC L ӊ NHTRÊNLINUX.............................................................                              | 6                                                                                                        |
| 3.1.                                                            | T ổ ch ứ c h ệ th ố ng t ậ p tin trên Linux                                                                   | ............................................................ 6                                           |
| 3.2.                                                            | Các l ệ nh thao tác trên h ệ th ố ng t ậ p tin                                                                | ........................................................ 6                                               |
| 3.2.1.                                                          | T ạ om ớ i th ư m ụ c.................................................................................        | 6                                                                                                        |
| 3.2.2.                                                          | Thay đổ i th ư m ụ c hi ệ n hành ...............................................................              | 7                                                                                                        |
| 3.2.3.                                                          | Xem th ư m ụ c làm vi ệ c hi ệ n hành .......................................................                 | 7                                                                                                        |
| 3.2.4.                                                          | Xem thông tin v ề t ậ p tin và th ư m ụ c...................................................                  | 7                                                                                                        |
| 3.2.5.                                                          | Di chuy ể nm ộ t hay nhi ề u t ậ p tin.........................................................               | 7                                                                                                        |
| 3.2.6.                                                          | Sao chép t ậ p tin...................................................................................         | 8                                                                                                        |
| 3.2.7.                                                          | T ạ o liên k ế t v ớ i t ậ p tin ........................................................................     | 8                                                                                                        |
| 3.2.8.                                                          | Tìm ki ế mm ộ t t ậ p tin                                                                                     | .......................................................................... 8                             |
| 3.2.9.                                                          | Xoá th ư m ụ c r ỗ ng                                                                                         | ............................................................................... 9                        |
| 3.2.10.                                                         | Xóa các t ậ p tin ho ặ c th ư m ụ c..............................................................             | 9                                                                                                        |
| 3.2.11.                                                         | Xem h ướ ng d ẫ n s ử d ụ ng l ệ nh.............................................................              | 9                                                                                                        |
| 3.2.12.                                                         | Hi ể n th ị n ộ i c ủ a các t ậ p tin .................................................................       | 9                                                                                                        |
| 3.2.13.                                                         | N ố i các t ậ p tin                                                                                           | ..................................................................................... 9                  |
| 3.2.14.                                                         | Xu ấ t n ộ i dung thông báo................................................................... ậ              | 10                                                                                                       |
| 3.2.15.                                                         | Nén và gi ả i nén t p tin                                                                                     | ...................................................................... 10                                |
| 3.3.                                                            | Các l ệ nh h ệ th ố ng......................................................................................  | 10                                                                                                       |
| 3.3.1.                                                          | L ệ nh at ..............................................................................................      | 10                                                                                                       |
| 3.3.2.                                                          | L ệ nh hostname..................................................................................             | 10                                                                                                       |
| 3.3.3.                                                          | L ệ nh ps.............................................................................................        | 10                                                                                                       |
| 3.3.4.                                                          | L ệ nh clear..........................................................................................        | 11                                                                                                       |
| 3.3.5.                                                          | L ệ nh date...........................................................................................        | 11                                                                                                       |
| 3.3.6.                                                          | L ệ nh cal <month> <year> ...............................................................                     | 11                                                                                                       |
| 3.3.7.                                                          | L ệ nh mount.......................................................................................           | 11                                                                                                       |
| 3.3.8.                                                          | Ti ệ n ích mc .......................................................................................         | 11                                                                                                       |
| 3.3.9.                                                          | Ti ệ n ích máy tính bc .........................................................................              | 12                                                                                                       |
| Bài 4 QU Ҧ N LÝ TÀIKHO Ҧ N VÀ PHÂN QUY ӄ N S Ӱ D Ө NG.......... | Bài 4 QU Ҧ N LÝ TÀIKHO Ҧ N VÀ PHÂN QUY ӄ N S Ӱ D Ө NG..........                                               | 13                                                                                                       |
| 4.1.                                                            | Qu ả n lý tài kho ả n c ủ a h ệ th ố ng.................................................................      | 13                                                                                                       |
| 4.1.1.                                                          | Tài kho ả n ng ườ i dùng.......................................................................               | 13                                                                                                       |
| 4.1.2.                                                          | Tài kho ả n nhóm ng ườ i dùng.............................................................                    | 13                                                                                                       |
| 4.2.                                                            | Phân quy ề n ng ườ i dùng trên h ệ th ố ng t ậ p tin............................................              | 13                                                                                                       |
| 4.2.1.                                                          | Các quy ề n truy xu ấ t trên t ậ p                                                                            | tin........................................................ 13                                           |
| 4.2.2.                                                          | L ệ nh chmod ......................................................................................           | 14                                                                                                       |
| 4.2.3.                                                          | Thay đổ i ng ườ i ho ặ c nhóm s ở h ữ u t ậ p tin ........................................                    | 14                                                                                                       |

| Bài 5   | S Ӱ D Ө NG TRÌNH SO Ҥ N TH Ҧ OVI...........................................                                       | 17                                                                          |
|---------|-------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
| 5.1.    | Gi ớ i thi ệ u................................................................................................... | 17                                                                          |
| 5.2.    | Kh ở i độ ng vi..............................................................................................     | 17                                                                          |
| 5.3.    | So ạ n th ả o v ă n b ả n......................................................................................   | 17                                                                          |
| 5.4.    | Thoát kh ỏ i vi..............................................................................................     | 18                                                                          |
| 5.4.1.  | Dùng vi v ớ i danh sách các l ệ nh đ ã ch ạ y c ủ a Shell...........................                              | 18                                                                          |
| Bài 6   | L Ұ P TRÌNH SHELL 21                                                                                              |                                                                             |
| 6.1.    | Ch ươ ng trình tính t ổ ng 1->                                                                                    | n..................................................................... 21   |
| 6.2.    | Ch ươ ng trình tính giai th ừ a c ủ am ộ t s ố                                                                    | ..................................................... 21                    |
| 6.3.    | Ch ươ ng trình đế ms ố dòng c ủ am ộ t t ậ p tin ...............................................                  | 21                                                                          |
| 6.4.    | Ch ươ ng trình đế ms ố t ừ c ủ am ộ t t ậ p tin ....................................................              | 22                                                                          |
| 6.5.    | Ch ươ ng trình tìm dòng có độ dài l ớ n nh ấ t trongm ộ t t ậ p tin..................... ộ ậ                      | 22                                                                          |
| 6.6.    | Ch ươ ng trình tìmm ộ t xâu trongm t t p                                                                          | tin.............................................. 23                        |
| Bài 7   | L ұ p trìnhC&C ++ 24                                                                                              |                                                                             |
| Bài 8   | QU Ҧ N LÝ TI ӂ N TRÌNH26                                                                                          |                                                                             |
| 8.1.    | Gi ớ i thi ệ u................................................................................................... | 26                                                                          |
| 8.1.1.  | T ạ om ộ t ti ế n trình - l ệ nh fork............................................................                 | 26                                                                          |
| 8.1.2.  | D ừ ngm ộ t ti ế n trình...........................................................................               | 26                                                                          |
| 8.1.3.  | Giao ti ế p gi ữ a các ti ế n trình..............................................................                 | 27                                                                          |
| 8.1.4.  | Liên l ạ c gi ữ a hai ti ế n trình................................................................                | 28                                                                          |
| 8.2.    | L ậ p trình đ a ti ế n trình ................................................................................     | 29                                                                          |
| 8.2.1.  | ố ng d ẫ n liên l ạ c.................................................................................            | 29                                                                          |
| 8.2.2.  | Thao tác v ớ i " ố ng d ẫ n liên l ạ c".........................................................                  | 30                                                                          |
| 8.2.3.  | Liên l ạ c gi ữ a ti ế n trình cha và ti ế n trình con                                                            | .................................... 30                                     |
| Bài 9   | L ұ p trìnhm ҥ ng TCP/IP 31                                                                                       |                                                                             |
| 9.1.    | L ậ p trình client /server theo giao th ứ c TCP/IP..........................................                      | 31                                                                          |
| 9.2.    | L ậ p trình client /server theo giao th ứ c UDP/IP.........................................                       | 36                                                                          |
| Bài 10  | DÞch vô FTP 39                                                                                                    |                                                                             |
| Bài 11  | CÁC T Ұ P TIN C Ҩ UHÌNHM Ҥ NG.............................................                                        | 41                                                                          |
| Bài 12  | C Ҩ U HÌNH D ӎ CH V Ө DNS ..........................................................                              | 43                                                                          |
| 12.1.   | Các t ậ p tin c ấ u hình d ị ch v ụ DNS                                                                           | ........................................... 43                              |
| 12.1.1. | T ậ p tin /etc/host.conf                                                                                          | ........................................................................ 43 |
| 12.1.2. | T ậ p tin /etc/resolv.conf .....................................................................                  | 43                                                                          |
| 12.1.3. | T ậ p tin /etc/named.conf                                                                                         | ................................................................... 43      |
| 12.1.4. | T ậ p tin /var/named/dng.vn.zone                                                                                  | ....................................................... 43                  |
| 12.1.5. | T ậ p tin /var/named/edu.vn.zone........................................................                          | 44                                                                          |
| 12.1.6. | T ậ p tin /var/named/0.0.127.in-addr.arpa.zone..................................                                  | 44                                                                          |
| 12.1.7. | T ậ p tin /var/named/localhost.zone...................................................                            | 44                                                                          |
| 12.1.8. | L ệ nh kh ở i độ ng d ị ch v ụ DNS...........................................................                     | 44                                                                          |
| 12.2.   | Các l ệ nh và ti ệ n ích h ỗ tr ợ ...........................................................                     | 45                                                                          |
| 12.2.1. | L ệ nh nslookup...................................................................................                | 45                                                                          |
| 12.2.2. | L ệ nh host...........................................................................................            | 45                                                                          |
| 12.2.3. | L ệ nh dig ............................................................................................           | 45                                                                          |
| 12.2.4. | Ti ệ n ích redhat-config-bind ..............................................................                      | 45                                                                          |

## Bài 1 ĐĂ NG NH Ậ P H Ệ TH Ố NG LINUX

## 1.1. Truy c ұ p vào máy tính đ ã cài đặ t h Ӌ đ i Ӆ u hành Linux

Kh ở i độ ng máy đ ã cài đặ t Linux, xu ấ t hi ệ n d ấ u nh ắ c kh ở i độ ng h ệ đ i ề u hành:

Boot : linux

Khi H Đ H Linux kh ở i độ ng, xu ấ t hi ệ n d ấ u nh ắ c truy c ậ p h ệ th ố ng :

login :

password :

Ng ườ i dùng nh ậ p vào username và password t ươ ng ứ ng, trên màn hình xu ấ t hi ệ n d ấ u nh ắ c c ủ a h ệ th ố ng nh ư sau :

[user12@linux user12]$

## 1.2. S ӱ d ө ng Telnet để truy c ұ p vào máy Linux t ӯ xa

Truy c ậ p vào Server LINUX t ừ máy Windows. Yêu c ầ u máy Windows đ ã cài đặ t m ạ ng. Để ki ể m tra h ệ th ố ng m ạ ng, t ừ d ấ u nh ắ c c ử a l ệ nh trên Windows, gõ l ệ nh :

C:\&gt;ping 200.201.202.180

N ế u trên màn hình xu ấ t hi ệ n :

Reply from 200.201.202.180 ...

thì ngh ĩ a là máy tính có kh ả n ă ng truy c ậ p vào Server LINUX, ng ượ c l ạ i, n ế u có thông báo nào khác thông báo nh ư trên thì nên ki ể m tra l ạ i c ấ u hình m ạ ng trên máy. Ti ế p theo, ta gõ l ệ nh :

## telnet 200.201.202.180

Sau m ộ t kho ả ng th ờ i gian thi ế t l ậ p liên k ế t, trên c ử a s ổ telnet xu ấ t hi ệ n :

login :

password :

- -Ng ườ i dùng nh ậ p vào username và password t ươ ng ứ ng.

Ví d ụ : Đă ng nh ậ p vào v ớ i tài kho ả n user12 , trên màn hình xu ấ t hi ệ n nh ư sau :

login: user12

Password:

Last login: Wed Apr  7 08:35:50 from 131.16.16.21

[user12@linux user12]$

## 1.3.

## Thoát kh ӓ i h Ӌ th ӕ ng

Thoát kh ỏ i phiên làm vi ệ c :

#exit

ho ặ c

#logout

Ch ấ m d ứ t ho ạ t độ ng c ủ a h ệ th ố ng :

#shutdown -h now

## Bài 2 NG E-Mail

## S Ӱ D Ө

Th ư đ i ệ n t ử hi ệ n nay đ ang tr ở thành ph ươ ng ti ệ n chính để liên l ạ c trên m ạ ng. Th ư đ i ệ n  t ử d ễ s ử d ụ ng,  ti ệ n  l ợ i  và  nhanh  chóng.  Trong  ph ầ n  này  ta  s ử d ụ ng  d ị ch  v ụ sendmail c ủ a h ệ th ố ng Linux.

## 2.1. G ở i th ư b ằ

## ng sendmail

Cú pháp

:  mail  &lt;address1&gt; &lt;address2&gt; &lt;address3&gt; . . .

## $mail   user01  root

-  Ti ế p theo, trên màn hình xu ấ t hi ệ

## Subject :

-  Sau khi nh ậ p vào n ộ i dung th ư , nh ấ n CTRL-D để g ở i th ư đ i.
- n
-  B ạ n gõ vào ch ủ đề b ứ c th ư . Nh ấ n Enter, b ắ t đầ u nh ậ p vào n ộ i dung th ư .
-  Trên màn hình xu ấ t hi ệ n :

CC :

-  Nh ậ p vào tên nh ữ ng ng ườ i cùng nh ậ n th ư ho ặ c nh ấ n Enter để b ỏ qua.

## 2.2. Nh ұ n th ư

- Khi có th n, trên màn hình xu t hi n thông báo :
-  ư đế ấ ệ

## You have mail

-  Để đọ c th ư , gõ vào l ệ nh : $mail
-  D ấ u &amp; nh ắ c r ằ ng b ạ n đ ang ở ch ươ ng trình đọ c th ư .
-  Trên màn hình s ẽ li ệ t kê các b ứ c th ư theo th ứ t ự 1, 2, 3 ... Để đọ c n ộ i dung th ư nào, gõ vào s ố th ứ t ự c ủ a b ứ c th ư đ ó.
-  Để xóa th ư đ ang đọ c, t ạ i d ấ u nh ắ c b ạ n gõ : &amp;d

&amp;q

-  Để thoát ch ươ ng trình đọ c th ư , t ạ i d ấ u nh ắ c b ạ n gõ :

Ví d ụ M ộ t phiên g ở i mail c ủ a user12 :

[user12@linux user12]$ mail user15 root

Subject: Chao ban

Thuc hanh LINUX

Cc:

[user12@linux user12]$

## 2.3. Các thao tác h ỗ tr ӧ

- -Để h ủ y b ỏ th ư tr ướ c khi g ở i, b ạ n nh ấ n CTRL-C hai l ầ
- n.
- -Đọ c n ộ i dung m ộ t t ậ p tin trên th ư m ụ c hi ệ n hành vào mail  : ~r  filename

- Thay đổ i ch ủ đề c ủ a th ư :

~s

- Xem t ấ t c ả các th ư l ư u trong h ộ p th ư :

$more mbox

## Các l Ӌ nh thao tác trên sendmail

```
t <message list> type messages n goto and type next message e <message list> edit messages f <message list> give head lines of messages d <message list> delete messages s <message list> file append messages to file u <message list> undelete messages R <message list> reply to message senders r <message list> reply to message senders and all recipients pre <message list> make messages go back to /usr/spool/mail p <message list> print message m <user list>   mail to specific users q quit, saving unresolved messages in mbox x quit, do not remove system mailbox h print out active message headers ! shell escape cd [directory]  chdir to directory or home if none given
```

## Bài 3 CÁC L Ệ NH TRÊN LINUX

## 3.1. T ổ ch ứ c h Ӌ th ӕ ng t ұ p tin trên Linux

/etc

C ấ u hình h ệ th ố ng c ụ c b ộ theo máy

/usr/bin

Ch ứ a h ầ u h ế t các l ệ nh ng ườ i dùng.

/dev

Các t ậ p tin thi ế t b ị .

/usr/man

Ch ứ a các tài li ệ u tr ự c tuy ế n.

/usr/include

Ch ứ a các t ậ p tin include chu ẩ n c ủ a C.

/var/log

Các t ậ p tin l ư u gi ữ thông tin làm vi ệ c hi ệ n hành c ủ a ng ườ i dùng.

/home

Ch ứ a các th ư m ụ c con c ủ a các user.

/usr/lib

Ch ứ a các t ậ p tin th ư vi ệ n c ủ a các ch ươ ng trình ng ườ i dùng.

Khi truy c ậ p vào h ệ th ố ng, th ư m ụ c làm vi ệ c c ủ a ng ườ i dùng đượ c xem nh ư là th ư m ụ c ch ủ . Ví d ụ : Th ư m ụ c ch ủ c ủ a user01 s ẽ là /home/user01

N ế u đườ ng d ẫ n b ắ t đầ u b ằ ng d ấ u ' / ', h ệ th ố ng xem đ ó nh ư là m ộ t tên đườ ng d ẫ n đầ y đủ b ắ t đầ u t ừ th ư m ụ c g ố c.

## 3.2. Các l Ӌ nh thao tác trên h Ӌ th ӕ ng t ұ p tin

Các tham s ố luôn b ắ t đầ u b ở i d ấ u '-', và trong h ầ u h ế t các tr ườ ng h ợ p nhi ề u tham s ố m ộ t ch ữ cái có th ể k ế t h ợ p dùng m ộ t d ấ u '-'.

Ví d ụ : Thay vì dùng l ệ nh ls -l -F , ta có th ể dùng l ệ nh t ươ ng đươ ng ls -lF.

| Kí t ӵ   | Ch ứ c n ĕ ng                                                                                               |
|----------|-------------------------------------------------------------------------------------------------------------|
| *?[ ]    | Kí t ự đạ i di ệ n hay theom ẫ u                                                                            |
| &        | Ch ạ y ứ ng d ụ ng ở ch ế độ n ề n (background), tr ả l ạ i d ấ u nh ắ c h ệ th ố ng cho các tác v ụ khác . |
| ;        | D ấ u phân cách nhi ề u l ệ nh trênm ộ t dòng l ệ nh.                                                       |
| \        | T ắ t tác d ụ ng c ủ a nh ữ ng kí t ự đặ c bi ệ t nh ư *, ?, [, ], &, ;, >, <, |                            |
| >        | Đị nh h ướ ng d ữ li ệ u xu ấ t ra file.                                                                    |
| <        | Đị nh h ướ ng d ữ li ệ u nh ậ p t ừ file.                                                                   |
| >>       | Đị nh h ướ ng d ữ li ệ u xu ấ t ra cu ố i file n ế u file đ ã t ồ n t ạ i.                                  |
| |        | Đị nh h ướ ng d ữ li ệ u xu ấ t là d ữ li ệ u nh ậ p cho l ệ nh ti ế p theo.                                |
| $        | S ử d ụ ng bi ế n môi tr ườ ng.                                                                             |

## 3.2.1. T ҥ o m ớ i th ư m ө c

Cú pháp

: mkdir &lt;dir1&gt; &lt;dir2&gt; ... &lt;dirN&gt;

&lt;dir1&gt; . . . &lt;dirN&gt; là tên các th ư m ụ c c ầ n t ạ o.

[user01@linux user01]$ mkdir baitap

[user01@linux user01]$ mkdir document

[user01@linux user01]$ mkdir baitap\ltc

[user01@linux user01]$ ls

[user01@linux user01]$ mkdir baitap/ltc

[user01@linux user01]$ mkdir baitap/perl

## 3.2.2. Thay đổ i th ư m ө c hi Ӌ n hành

## Cú pháp : cd &lt;directory&gt;

&lt;directory&gt; là th ư m ụ c mu ố n chuy ể n đế n.

- . :  yêu c ầ u chuy ể n đế n th ư m ụ c hi ệ n hành.
- .. : chuy ể n đế n th ư m ụ c cha.

[user01@linux user01]$ cd baitap

[user01@linux user01]$ cd /home

[user01@linux user01]$ cd

## 3.2.3. Xem th ư m ө c làm vi Ӌ c hi Ӌ n hành

Cú pháp :

pwd

[user12@linux user12]$ pwd /home/user12 [user12@linux user12]$

## 3.2.4. Xem thông tin v Ӆ t ұ p tin và th ư m ө c

&lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt; &lt;Tham s ố &gt;

Cú pháp :

ls

&lt;file1&gt; . . . &lt;fileN&gt; là danh sách tên t ậ p tin hay th ư m ụ c.

## &lt;Tham s ố &gt; :

- -F  : dùng để hi ể n th ị m ộ t vài thông tin v ề ki ể u c ủ a t ậ p tin
- -l  : (long) li ệ t kê kích th ướ c t ậ p tin, ng ườ i t ạ o ra, các quy ề n ng ườ i s ử d ụ ng.

[user12@linux user12]$ ls -lF total 75

drwxrwxr-x    2 user12 user12 1024 Apr  7 09:41 baitap/ drwxrwxr-x    2 user12 user12 1024 Apr  7 09:41 doc/ -rwxrwxr-x     1 user12 user12         71 Mar 31 10:39 hello* -rw-rw-r-- 1 user12 user12 126 Apr  7 09:26 baitho.txt -rw-rw-r-- 1 user12 user12         70 Apr  7 08:26 hello.c [user12@linux user12]$

ls -lF

ls *a*

: hi ể n th ị t ấ t c ả t ậ p tin hay th ư m ụ c con có kí t ự a

ls F*E

: hi ể n th ị danh sách b ắ t đầ u b ằ ng F và k ế t thúc b ằ ng E

## 3.2.5. Di chuy n m t hay nhi u t p tin

## ể ộ Ӆ ұ

Cú pháp

: mv &lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt; &lt;destination&gt;

&lt;file1&gt; . . . &lt;fileN&gt; là danh sách tên t p tin c n di chuy

&lt;destination&gt; là t p tin hay th m c

ậ ầ ể n ậ ư ụ đ ích.

L ệ nh mv có th ể dùng để đổ i tên t ậ p tin.

- Chuy ể n nhi ề u t ậ p tin
- $ mv  * directory · Di chuy ể n th ư m ụ c

[user01@linux user01]$ mkdir ctrinh [user01@linux user01]$ ls -lF

[user01@linux user01]$ mv ctrinh baitap

Di chuy ể n th ư m ụ c /home/user01/ctrinh vào th ư m ụ c /home/user01/baitap

## 3.2.6. Sao chép t ұ p tin

## Cú pháp : cp &lt;source&gt; &lt;destination&gt;

[user01@linux user01]$ cd baitap

[user01@linux baitap]$ vi tho.txt

[user01@linux baitap]$ mv tho.txt baitho.doc

[user01@linux baitap]$ ls baitho.doc  ctrinh      hello.c     ltc         perl

- [user01@linux baitap]$ cp baitho.doc ~/document · Sao chép t ấ t c ả các t ậ p tin vào m ộ t danh m ụ c

$ cp   *   directory

## 3.2.7. T ҥ o liên k Ӄ t v ớ i t ұ p tin

T ạ o liên k ế t v ớ i t ậ p tin là t ạ o thêm cho t ậ p tin tên m ớ i và đườ ng d ẫ n t ươ ng ứ ng.

## Cú pháp : ln   &lt;source&gt; &lt;destination&gt;

ls  -l : xem s ố liên k ế t c ủ a t ậ p tin.

Mu ố n xóa m ộ t t ậ p tin ta ph ả i xoá t ấ t c ả các liên k ế t c ủ a nó.

[user01@linux user01]$ pwd

[user01@linux user01]$ ls  -l

[user01@linux user01]$ ls  -l  baitap

[user01@linux user01]$ ln  baitap/file1   file.link

[user01@linux user01]$ ls  -l  baitap

[user01@linux user01]$ ls  -l  file.link

## 3.2.8. Tìm ki ế m m ộ t t ậ p tin

L ệ nh find cho phép tìm ki ế m m ộ t hay nhi ề u t ậ p tin trong m ộ t cây danh m ụ c.

find    &lt; path&gt;  -name   &lt; filename&gt;

- Tìm theo s ố i-node c ủ a t ậ p tin:

find   &lt; path&gt;  -inum &lt; number&gt;

- Tìm theo tên ng ườ i s ở h ữ u :

find &lt; path&gt;  -user  &lt; username&gt;

- Tìm theo tên:

Để tránh  các  thông  báo  l ỗ i đư a  ra  màn  hình,  ta  có  th ể đổ i  h ướ ng đầ u  ra  l ỗ i chu ẩ n ( standard error ) t ớ i m ộ t t ậ p tin r ỗ ng (/dev/null ):

$ find   /   -name   filename   - print   2&gt;/dev/null

Ví d ụ :

$ pwd

/home/user01

$ find  / -name  ttyc2d1   - print   2&gt;/dev/null

/dev/ttyc2d1

$ ls  -i   /unix

2810  - r- xr- - r- -   2   bin   bin   508516    Mar    10  1989   /unix $find  /   -inum  2810   - print   2&gt;/dev/null

## 3.2.9. Xoá th ư m ө c r ỗ ng

Cú pháp

## : rmdir &lt;dir1&gt; &lt;dir2&gt; ... &lt;dirN&gt;

&lt;dir1&gt; ... &lt;dirN&gt; là tên nh ữ ng th ư m ụ c c ầ n xóa.

rmdir /home/baitap

xóa th ư m ụ c /home/baitap

- 3.2.10. Xóa các t ậ p tin ho ặ c th ư m ụ c
- 3.2.11. Xem h ướ ng d ẫ n s ử d ụ ng l ệ nh

Cú pháp

: rm &lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt;

Cú pháp :

man &lt;command&gt;

ho?c

&lt;command&gt;  --help

&lt;command&gt;  /?

Trong đ ó &lt;command&gt; là tên c ủ a m ộ t c ầ n xem h ướ ng d ẫ n.

[user12@linux user12]$ man ls [user12@linux user12]$ cp --help

[user12@linux user12]$ cp --help &gt;cp.txt

## 3.2.12. Hi ể n th ӏ n ộ i c ủ a các t ұ p tin

## Cú pháp : more &lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt;

&lt; file1 &gt;  &lt; file2 &gt;  ... &lt; fileN&gt; là nh ữ ng t ậ p tin c ầ n hi ể n th ị .

[user12@linux user12]$more baitho.txt

// hi ể n th ị t ậ p tin baitho.txt ấ ả ư ư ộ ư

[user12@linux user12]$more mbox

// Xem t t c th l u trong h p th

## 3.2.13. N ӕ i các t ұ p tin

## Cú pháp : cat &lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt; [&gt;filename]

L ệ nh dùng để hi ể n th ị toàn b ộ n ộ i dung c ủ a nhi ề u t ậ p tin cùng m ộ t lúc.

&lt;file1&gt; &lt;file2&gt; ... &lt;fileN&gt; là nh ữ ng t ậ p tin c ầ n hi ể n th ị n ộ i dung.

Ví d ụ :

Hi n th n i dung hai t p tin baitho.txt và vanban.doc

ể ị ộ ậ $cat baitho.txt vanban.doc

ế ố ộ ậ ậ

K t n i n i dung hai t p tin baitho.txt và vanban.doc vào t p tin thop.doc $cat baitho.txt vanban.doc &gt;thop.doc

## 3.2.14. Xu ҩ t n ộ i dung thông báo

## Cú pháp : echo   &lt;arg1&gt; &lt;arg2&gt; ... &lt;argN&gt;

Trong đ ó &lt;arg1&gt; &lt;arg2&gt; ... &lt;argN&gt; là các đố i s ố dòng l ệ nh.

[user12@linux user12]$ echo 'Chao cac ban'

Chao cac ban sinh vien'

[user12@linux user12]$ echo *

## 3.2.15. Nén và gi ҧ i nén t ұ p tin

## Cú pháp :

## gzip &lt;filename&gt;

Nén m ộ t t ậ p tin. Tên t ậ p tin nén gi ố ng nh ư tên ban đầ u, kèm theo đ [user12@linux user12]$ gzip vanban.txt -&gt;  vanban.txt.gz

Cú pháp :

gunzip &lt;filename&gt; gzip -d &lt;filename&gt;

L ệ nh dùng để gi ả i nén t ậ p tin. [user12@linux user12]$gunzip vanban.txt.gz

## 3.3. Các l Ӌ nh h Ӌ th ӕ ng

## 3.3.1. L Ӌ nh at

Th ự c hi ệ n l ệ nh theo th ờ i gian đị nh tr ướ

[user12@linux user12]$ at 8:15am Feb 27 echo Happy birthday | mail emily  &lt;CR&gt; &lt;^d&gt;

[user12@linux user12]$ atrm jobnumber [user12@linux user12]$ at -l

## 3.3.2. L Ӌ nh hostname

Hi ể n th ị tên máy tính đ ang làm vi ệ c.

H th ng l u thông tin v tên máy trong t p tin /etc/hosts

ệ ố ư ề ậ

[user12@linux user12]$ hostname linux.edu.vn

## 3.3.3. L Ӌ nh  ps

Xem danh sách các ti ế n trình đ ang ho ạ t độ ng trên h ệ th ố ng. [user12@linux user12]$ ps PID TTY STAT TIME COMMAND

xóa l ệ nh trong hàng đợ i hi ể n th ị danh sách các l ệ nh trong hàng đợ i

c

→ Hi ể n th ị n ộ i dung th ư m ụ c uôi .gz

- 4516  p4 S    0:00 -bash

- 4703  p4 S    0:00 /usr/bin/mc -P

- 4705  r0 S    0:00 bash -rcfile .bashrc

4727  r0 R    0:00 ps

[user12@linux user12]$ kill 4703

//H ủ y b ỏ ti ế n trình mc có s ố hi ệ u 4703

Terminated

## 3.3.4. L Ӌ nh clear

Xóa màn hình.

## 3.3.5. L Ӌ nh date

Hi ể n th ị ngày tháng hi ệ n hành c ủ a h ệ th ố ng

## 3.3.6. L Ӌ nh cal  &lt;month&gt; &lt;year&gt;

Xem l ị ch t ươ ng ứ ng v ớ i tháng và n ă m ch ỉ đị nh.

## 3.3.7. L Ӌ nh mount

## Cú pháp : mount [-t &lt;type&gt;]  &lt;device&gt;  &lt;mountpoint&gt;

- -L ệ nh dùng để k ế t n ố i h ệ đ i ề u hành v ớ i các thi ế t b ị khác trên h ệ th ố ng.
- -L ệ nh này ch ỉ th ự c hi ệ n đượ c khi b ạ n vào h ệ th ố ng v ớ i t ư cách là root .

type

: Ki ể u t ậ p tin

device

: T ậ p tin đ i ề u khi ể n thi ế t b ị k ế t n ố i.

mountpoint

: V ị trí th ư m ụ c trên h ệ đ i ề u hành dùng để k ế t n ố i v ớ i file thi ế t b ị .

: #mount  /dev/hda1   /mnt/hdisk

- T ạ o k ế t n ố i v ớ i đĩ a m ề m  MS-DOS

:   #mount  /dev/fd0      /mnt/floppy

- T ạ o k ế t n ố i v ớ i đĩ a m ề m  LINUX  :   #mount   -t   ext2      /dev/fd0      /mnt/floppy

- T ạ o k ế t n ố i v ớ i đĩ a CDROM   :

#mount  /dev/hda1   /mnt/cdrom

- H ủ y k ế t n ố i v ớ i đĩ a m ề m :

#umount /dev/fd0

- T ạ o k ế t n ố i v ớ i đĩ a logic 1

Chú ý : H ệ th ố ng Linux xem các thi ế t b ị k ế t n ố i nh ư các m ộ t t ậ p tin đặ c bi ệ t.

## n ích mc

## 3.3.8. Ti Ӌ

Ti ệ n ích mc trên Linux có giao di ệ n làm vi ệ c gi ố ng nh ư trình NC Command c ủ a MS - DOS. Để kh ở i độ ng mc gõ l ệ nh nh ư sau :

#mc

## 3.3.9. Ti ệ n ích máy tính bc

Ch ươ ng trình bc cung c ấ p m ộ t b ộ máy tính tay giúp ng ườ i dùng có th ể tính toán các bi ể u th ứ c, các hàm toán h ọ c ...

## 3.3.9.1. Kh ở i độ ng bc

```
T ừ d ấ u nh ắ c h ệ th ố ng, b ạ n gõ : #bc ↵ xu ấ t hi ệ n d ấ u nh ắ c, b ạ n có th ể nh ậ p vào các bi ể u th ứ c tính toán : (4+5)*(12-10) ↵ 18 1000000000000*1000000000000 ↵ 1000000000000000000000000 Để ấ n đị nh s ố ch ữ s ố th ậ p phân, dùng l ệ nh scale = n : scale=3 ↵ 1/6 ↵ . 166 L ậ p trình trong bc. define giaithua(n) { if (n<=1) return (1); else return (gt(n-1)*n); } gt(5) 120 Để chuy ể n đổ i  sang các c ơ s ố khác nhau, dùng các l ệ ibase=c ơ s ố Đị nh d ạ ng c ơ s ố đầ u vào obase=c ơ s ố Đị nh d ạ ng c ơ s ố xu ấ t ra ibase và obase ng ầ m đị nh là c ơ s ố 10 ibase=16 ↵ FF ↵ 255 obase=2 ↵ FF ↵ 11111111 ibase ↵ obase ↵ 3.3.9.2.  K ế t thúc bc Nh ấ n CTRL-D để thoát. #man bc -> Xem các h ướ ng d ẫ n s ử d ụ ng bc.
```

nh ibase và obase

## Bài 4 QU Ả N LÝ TÀI KHO Ả N VÀ PHÂN QUY Ề N S Ử D Ụ NG

Mô t ả c ơ ch ế b ả o v ệ t ậ p tin c ủ a LINUX: ng ườ i s ử d ụ ng, nhóm ng ườ i s ử d ụ ng, các quy ề n truy xu ấ t trên t ậ p tin.

## 4.1. Qu n lý tài kho n c a h th ng

## ҧ ҧ ủ Ӌ ӕ

## 4.1.1. Tài kho ҧ n ng ườ i dùng

M ỗ i ng ườ i s ử d ụ ng trên h ệ th ố ng đượ c mô t ả qua các thông tin sau:

- username : tên ng i s d

ườ ử ụ ng

- password : m ậ t kh ẩ u (n ế

u có)

- uid :  s nh n d

ố ậ ạ ng (user identify number )

- gid :  s c

ố ủ a nhóm (group identify number )

- -comment : chú thích
- -Th m c ch c a tài kho
- ư ụ ủ ủ ả n (home directory )
- -Shell đă ng nh ậ p (ch ươ ng trình ch ạ y lúc b ắ t đầ u phiên làm vi ệ c)

Các thông tin trên đượ c ch ứ a trong t ậ p tin /etc/passwd

## i dùng

## 4.1.2. Tài kho ҧ n nhóm ng ườ

M ộ t nhóm ng ườ i s ử d ụ ng đượ c mô t ả b ằ ng các thông tin sau:

- groupname : tên c ủ a nhóm

- gid : s c

ố ủ a nhóm (gid: group identify number)

- danh sách các tài kho ả n thu ộ c nhóm

Các thông tin trên đượ c ch ứ a trong t ậ p tin /etc/group

## 4.2. Phân quy Ӆ n ng ườ i dùng trên h Ӌ th ӕ ng t ұ

## 4.2.1. Các quy Ӆ n truy xu ҩ t trên t ұ

## p tin

Khi t ậ p tin đượ c t ạ o l ậ p,  các thông tin sau đ ây đồ ng th ờ i đượ c ghi l ạ i:

- -uid c a ng i t o t p tin
- ủ ườ ạ ậ
- -gid c a ng i t o t p tin
- ủ ườ ạ ậ
- -Các quy n thâm nh p t
- ề ậ ậ p tin khác . . .
- -T ậ p tin đượ c b ả o v ệ b ở i m ộ t t ậ p h ợ p các bit đị nh ngh ĩ a quy ề n thâm nh ậ p

r w x suid owner

r w x sgid group

r w x

other

Trong đ ó:

## p tin

- r Quy ề n đọ c n ộ i dung t ậ p tin, th ư m ụ c
- w Quy ề n t ạ o và xoá n ộ i dung t ậ p tin, t ạ o và xóa t ậ p tin trong th ư m ụ c
- x Quy ề n th ự c thi t ậ p tin. Quy ề n truy xu ấ t qua l ạ i trên th ư m ụ c.
- L ệ nh ls  -lF li ệ t  kê  danh sách các t ậ p tin và các thu ộ c tính c ủ a chúng trong m ộ t danh m ụ c, qua đ ó ta có th ể xem các thông tin nh ư lo ạ i  t ậ p tin, quy ề n truy nh ậ p, ng ườ i s ở h ữ u và kích th ướ c c ủ a t ậ p tin. . .
- Các quy ề n v ớ i th ư m ụ c ch ỉ có hi ề u l ự c ở m ộ t m ứ c nh ấ t đị nh, th ư m ụ c con có th ể đượ c b ả o v ệ trong khi th ư m ụ c cha thì không.

## 4.2.2. L Ӌ nh chmod

L ệ nh chmod cho  phép  thay đổ i  quy ề n  trên  t ậ p  tin  c ủ a  ng ườ i  dùng.  Ch ỉ nh ữ ng ng ườ i s ở h ữ u t ậ p tin này m ớ i có th ể thay đổ i đượ c m ứ c đặ c quy ề n đố i v ớ i t ậ p tin này. Có th ể th ự c hi ệ n l ệ nh theo hai cách:

## 4.2.2.1. Dùng các ký hi ệ u t ượ ng tr ư ng:

## Cú pháp : chmod {a,u,g,o}{+,-,=}{r,w,x} &lt;filename&gt;

Trong đ

ó  : u (user), g (group), o (other), a (all)

Các toán t

ử

: + thêm quy ề n.  -  b ớ t quy ề n.  =  gán giá tr ị khác

## 4.2.2.2. Dùng thông s ố tuy ệ t đố i

## Cú pháp : chmod    &lt;mode&gt;    &lt;filename&gt;

trong đ ó mode là m ộ t s ố c ơ s ố 8 ( octal )

$$r w x r  - x r  -  - 1 1 1 1 0 1 1 0 0 7 5 4$$

$chmod  754  filename

$chmod  g-w,o+r   baitho.doc

$chmod  a+r baocao.txt

$chmod  +r baocao.txt

$chmod  og-x baocao.txt

không cho th ự c thi cho  phép ng ườ i s ở h ữ u có th ể đọ c, vi ế t và th ự c thi. không cho truy nh ậ p t ậ p tin. Đặ t các quy ề n cho t ấ t c ả các đố i t ượ ng s ử d ụ ng . trên toàn b ộ t ậ p tin trong th ư m ụ c hi ệ n hành

$chmod  u+rwx baocao.txt

$chmod  o-rwx baocao.txt

$chmod  777   *

## 4.2.3. Thay đổ i ng ườ i ho ặ c nhóm s ở h ӳ u t ұ p tin

- -L ệ nh chown cho phép thay đổ i ng ườ i s ở h ữ u, nhóm s ở h ữ u trên t ậ p tin.
- -L ệ nh chgrp cho phép thay đổ i nhóm s ở h ữ u trên t ậ p tin.

## 1. Thay đổ i quy Ӆ n trên t ұ p tin

#cat bai1.sh #ls -lF bai1.sh #chmod u+x,g+wx bai1.sh #ls -lF bai1.sh #chmod 644 bai1.sh #ls -lF bai1.sh #chmod 764 bai1.sh #ls -lF bai1.sh #chmod 777 bai1.sh #ls -lF bai1.sh

## 2.  T ҥ o tài kho ҧ n h Ӌ th ӕ ng

```
T ạ o nhóm cntt2004 #groupadd cntt2004 Xem t ậ p tin /etc/group #cat /etc/group T ạ o m ộ t account user01 m ớ i thu ộ c nhóm cntt2004 #useradd - g cntt2004 -c 'Tai khoan user01' user01 #passwd user01 Xem t ậ p tin /etc/passwd, /etc/shadow #cat /etc/passwd #cat /etc/shadow Th ử đă ng nh ậ p vào h ệ th ố ng v ớ i tài kho ả n là user01 T ạ o m ộ t account user02 #useradd user02 #passwd user02 Đư a user02 vào nhóm cntt2004 #usermod -g cntt2004 user02 Th ử đă ng nh ậ p vào h ệ th ố ng v ớ i tài kho ả n là user02 Xóa user02 #userdel user02 #cat /etc/passwd
```

## 3. Thay đổ i quy Ӆ n s ӱ d ө ng cho các đӕ i t ưӧ ng trên t ұ p tin

- a.  T ạ o m ộ t t ậ p tin m ớ i /home/baocao.txt
- b. Đổ i ch ủ s ở h ữ u c ủ a t ậ p tin /home/baocao.txt là user01

## TH Ӵ C HÀNH

#chown user01 /home/baocao.txt

- c.  Phân quy ề n rwxr--r-- cho các đố i t ượ ng trên t ậ p tin /home/baocao.txt. #chmod 744 /home/baocao.txt
- d. Đă ng nh ậ p vào h ệ th ố ng v ớ i tài kho ả n user01. Th ử thay đổ i n ộ i dung t ậ p tin /home/baocao.txt.
- e. Đă ng nh ậ p  vào  h ệ th ố ng v ớ i  tài  kho ả n  khác.  Th ử thay đổ i  n ộ i  dung  t ậ p tin /home/baocao.txt. Nh ậ n xét ?

## 4.  Phân quy n s d ng cho các i t ng

## Ӆ ӱ ө đӕ ưӧ

- a.  T ạ o nhóm ng ườ i s ử d ụ ng có tên cntt2004.
- b. B ổ sung các user01, user02  vào nhóm cntt2004. #usermod -g cntt2004 user01 #usermod -g cntt2004 user02
- c.  T ạ o th ư m ụ c /home/common #mkdir /home/common
- d. Đổ i nhóm s ở h ữ u c ủ a th ư m ụ c /home/common là nhóm cntt2004. #chown :cntt2004 /home/common

ho ặ c

#chgrp cntt2004 /home/common

- e.  Phân quy ề n rwx cho đố i t ượ ng nhóm cntt2004 trên th ư m ụ c /home/common #chmod g+rwx /home/common #ls -lF /home
- f. Đă ng  nh ậ p  vào  h ệ th ố ng  v ớ i  tài  kho ả n  user01.  T ạ o  th ư m ụ c  m ớ i  trong /home/common.
- g. Đă ng nh ậ p vào h ệ th ố ng v ớ i m ộ t tài kho ả n khác không thu ộ c nhóm cntt2004. Th ử t ạ o th ư m ụ c m ớ i trong /home/common. Nh ậ n xét ?.

## Bài 5 S Ӱ D Ө NG TRÌNH SO Ҥ N TH Ҧ O VI

Gi ớ i thi ệ u trình so ạ n th ả o vi, các thao tác so ạ n th ả o t ậ p tin b ằ ng vi.

## 5.1. Gi ớ i thi Ӌ u

vi là ch ươ ng trình so ạ n th ả o các t ậ p tin v ă n b ả n trên các h ệ th ố ng Unix :

- -Màn hình đượ c xem nh ư m ộ t c ử a s ổ m ở trên t ậ p tin.
- -Có kh ả n ă ng di chuy ể n con tr ỏ đế n b ấ t k ỳ v ị trí nào trên màn hình.
- -C ử a s ổ có th ể di chuy ể n t ự do trên t ậ p tin.

Ph ầ n l ớ n các phím dùng độ c l ậ p ho ặ c k ế t h ợ p v ớ i phím Shift và Ctrl để t ạ o ra các l ệ nh c ủ a vi. Các l ệ nh c ủ a vi có th ể đượ c g ọ i khi có d ấ u " : " ở dòng cu ố i màn hình.

Có 2 ch ế độ (mode) trong khi s ử d ụ ng vi: Append mode và Command mode

<!-- image -->

## 5.2. Kh ở i độ ng vi

Ta có th g i vi v i tên t p tin v n b

ể ọ ớ ậ ă ả n : $ vi   filename

Ví d ụ :

vi bai1.txt   &lt; Enter &gt;

Màn hình so ạ n th ả o hi ệ n ra nh ư sau ( ở đ ây đ ang dùng Telnet để n ố i vào UNIX ) :

<!-- image -->

- -D ấ u  ngã (~) tr ướ c m ỗ i dòng cho bi ế t dòng đ ó còn r ỗ ng (tr ố ng)
- -Dòng d ướ i cùng cho bi ế t tên file đ ang m ở , tr ạ ng thái c ủ a file: n ế u là file m ớ i thì "[new file]", n ế u m ở file  c ũ thì  s ẽ hi ể n th ị s ố dòng,  s ố ký  t ự trong  file  (hình d ướ i).

## 5.3. So ҥ n th ҧ o v ĕ n b ҧ n

- -Chèn ký t ự trên m ộ t dòng a  &lt; text &gt; &lt; ESC &gt;
- -S ử d ụ ng các phím so ạ n th ả o v ă n b ả n.

- -Nh ấ n phím  ESC để k ế t thúc ch ế độ chèn v ă n b ả n.

## 5.4. Thoát kh ӓ i vi

ố ỏ ạ ộ ậ ạ ộ t trong

Mu n ra kh i vi và ghi l i n i dung t p tin, b n nh ҩ n phím ESC và dùng m các l ệ nh nh ư sau:

- :ZZ ho ặ c :wq ho ặ c :x

Thoát kh i vi và không ghi l i các thay i tr c ó

ỏ ạ đổ ướ đ

: q!

Khi ở trong ch ế độ so ạ n th ả o c ủ a vi , mu ố n ch ạ y ch ươ ng trình  shell, dùng l ệ nh :

## : ! &lt;shellcommand&gt;

ho ặ c g ọ i shell, sau đ ó ch ạ y các l ệ nh c ủ a ng ườ i dùng, khi k ế t thúc b ấ m Ctrl-D để tr ở

l ạ i vi :

: ! sh

- $ &lt;command&gt;

## $ Ctrl-D

## 5.4.1. Dùng vi v ớ i danh sách các l Ӌ nh đ ã ch ҥ y c ủ

## a Shell

ệ ạ ả ằ ạ ạ ệ đ ạ y

L nh fc ( fix command ) cho phép ta so n th o b ng vi và ch y l i các l nh ã ch c ủ a Shell. Cách dùng nh ư sau:

- -So ạ n th ả o và cho ch ạ y l ệ nh cu ố i cùng: $fc
- -So ạ n th ả o m ộ t nhóm l ệ nh và cho ch ạ y:
- -Xem danh sách 16 l ệ nh cu ố
- i cùng:
- -T ạ o m ộ t t ậ p tin ch ứ a m ộ t s ố l ệ nh đ ã ch ạ y (c ủ

- $ fc   -l ho ặ c    history

- $ fc   -lr (danh sách theo th ứ t ự ng ượ c l ạ i)

## $fc -nl   n1   n2   &gt; cmd

cmd là m ộ t t ậ p tin ch ứ a các l ệ nh c ủ a history t ừ l ệ nh n1 đế n l ệ nh n2

## B ҧ ng tóm t ắ t các l Ӌ nh c ủ a vi

| <i>    | Inserts text before cursor    |
|--------|-------------------------------|
| <I>    | Enters text at start of line  |
| <a>    | Inserts text after cursor     |
| <A>    | Enters text at end of line    |
| <o>    | Opens a new line below cursor |
| <O>    | Opens a new line above cursor |
| <d><w> | Deletes word                  |
| <d><d> | Deletes entire line           |

- a history):
- $ fc  m  n

&lt;D&gt;

Deletes to end of line

&lt;x&gt;

Deletes character under cursor

&lt;c&gt;&lt;w&gt;

Changes word

&lt;c&gt;&lt;c&gt;

Changes line

&lt;C&gt;

Changes to end of line

&lt;R&gt;

Replaces character under cursor

&lt;J&gt;

Joins lines together

&lt;e&gt;

Moves to end of word

&lt;w&gt;

Moves to next word

&lt;$&gt;

Moves to end of line

&lt;l&gt;

Moves one space right

&lt;k&gt;

Moves one line up

&lt;j&gt;

Moves one line down

&lt;h&gt;

Moves one space left

&lt;f&gt;&lt;x&gt;

Moves cursor to first occurrence of x

&lt;F&gt;&lt;x&gt;

Moves cursor to last occurrence of x

&lt;;&gt;

Repeats the last f/F command

number

&lt;|&gt;

Moves cursor to specified column number

&lt;H&gt;

Moves cursor to top line on-screen (not top line of file)

&lt;L&gt;

Moves cursor to bottom line on-screen

&lt;M&gt;

Moves cursor to middle line on-screen

&lt;G&gt;

Moves cursor to bottom line of file

number

&lt;G&gt;

Moves cursor to specified line

number

(same as&lt;ESC&gt;:

number

)

&lt;^&gt;

Moves to beginning of line

&lt;m&gt; x

Marks current position with letter x

&lt;Ctrl-d&gt;

Scrolls for ward one half of the screen

&lt;Ctrl-u&gt;

Scrolls backward one half of the screen

&lt;Ctrl-f&gt;

Scrolls for ward one screen

&lt;Ctrl-b&gt;

Scrolls backward one screen

&lt;Ctrl-l&gt;

Redraws the screen

&lt;Ctrl-G&gt;

Shows the filename, current line, and column number

&lt;z&gt;&lt;z&gt;

Redraws the screen with current line in middle of screen

&lt;y&gt;&lt;y&gt;

Yanks entire line into buffer

&lt;p&gt;

Puts contents of buffer below cursor

&lt;P&gt;

Puts contents of buffer above cursor

x '[ number ]'&lt;yy&gt; Yanks the indicated number of lines into the buffer named x ( x can be any single character a-z)

x &lt;p&gt;

Places the contents of buffer x after the cursor

:w [file]

Writes contents to disk as file

:q

Quits vi

:q!

Quits file without saving changes

:wq

Saves changes and quits vi

:r file

Reads specified file into editor

:e file

Edits file

:! command

Executes specified shell command

: number

Moves to specified line number

:f

Prints out current line and filename (same as &lt;Ctrl-G&gt;)

/ string

Searches forward for string

? string

Searches backward for string

: x , ys / oldstring / newstring

Replaces oldstring with newstring from line x to line y

(entering y = $ will replace to end of file)

&lt;ESC&gt;&lt;u&gt;

Undoes last command

&lt;n&gt;

Finds next occurrence of string. Repeats last command

~

Changes character to opposite case

&lt;ESC&gt;

Switches to command mode

## TH Ӵ C HÀNH

1.  Dùng ch ươ ng trình vi để so ạ n th ả o t ậ p tin vanban.doc $vi   vanban.doc
2.  Sao chép v ă n b ả n
3. Đặ t và b ỏ ch ế độ hi ể n th ị s ố dòng :
4.  L ư u n ộ i dung t ậ p tin và thoát kh ỏ i vi: :wq
5.  Xem lai n ộ i dung t ậ p tin vanban.doc.

4dd

C ắ t 4 dòng và đư a vào vùng đệ m

Ctrl+d

Chuy ể n xu ố ng cu ố i v ă n b ả n

- p

Sao t ừ vùng đệ m vào sau dòng hi ệ n hành

:set   nu

:set   nonu

## L Ұ P TRÌNH SHELL

## 6.1. Ch ươ ng trình tính t ổ ng 1-&gt; n

- -Minh h ọ a các c ấ u trúc while do done, và cách s ử d ụ ng [], $(()).

```
-T ậ p tin tong1.sh #!/bin/sh echo 'Chuong trinh tinh tong 1- $1' index=0 tong=0 while [ $index -lt $1 ] do index=$(($index + 1)) tong=$(($tong + $index)) done echo "Tong 1-$1= $tong" exit 0 -Ch ạ y ch ươ ng trình : chmod a+x tong1.sh ./tong1 100
```

## 6.2. Ch ươ ng trình tính giai th ӯ a c ủ a m ộ t s ӕ

- -Minh h ọ a các c ấ u trúc while do done, và cách s ử d ụ

```
-T p tin giaithua.sh #!/bin/sh echo 'Chuong trinh tinh $1!' index=0 gt=1 while [ $index -lt $1 ] do gt=$(($gt * $index)) done echo "$1!= $gt" exit 0 -Ch ạ y ch ươ ng trình : chmod a+x giaithua.sh ./giaithua 5
```

```
ng [], $(()). ậ index=$(($index + 1))
```

## 6.3. Ch ươ ng trình đӃ m s ӕ dòng c ủ a m ộ t t ұ p tin

- -Minh h ọ a các c ấ u trúc if then fi, while do done, và cách s ử d ụ ng [], $(()).
- -T ậ p tin demdong.sh

```
#!/bin/sh echo 'Chuong trinh dem so dong cua tap tin $1' { n=0 while read line
```

```
do n=$(($n + 1)) done }<$1
```

```
#!/bin/sh { n=0 while read line do for wd in $line do n=$(($n + 1)) done done echo 'Tong so tu cua tap tin $1 la : $n' }<$1
```

- echo 'So dong cua tap tin $1 la : $n' exit 0 -Ch ạ y ch ươ ng trình : chmod a+x demdong.sh ./demdong bai1.txt 6.4. Ch ươ ng trình đӃ m s ӕ t ӯ c ủ a m ộ t t ұ p tin -Minh h ọ a các c ấ u trúc for do done, while do done. -T ậ p tin demtu.sh echo 'Chuong trinh dem so tu cua tap tin $1'
- exit 0 -Ch ạ y ch ươ ng trình : chmod a+x demtu.sh ./demtu bai1.txt

## 6.5. Ch ng trình tìm dòng có dài l n nh t trong m t t p tin

## ươ độ ớ ҩ ộ ұ

- -Minh h ọ a các c ấ u trúc if then fi, while do done.
- -T ậ p tin dongmax.sh

```
#!/bin/sh echo 'Chuong trinh tim dong dai nhat trong tap tin $1' { n=0 max=0 dong='' while read line do n=`expr length '$line'` if [ $n -gt $max ] then dong='$line'
```

```
max=$n fi done }<$1 exit 0 -Ch ạ y ch ươ ng trình : chmod a+x dongmax.sh
```

```
echo 'Dong trong tap tin $1 co do dai max = $max la : $dong' ./dongmax bai1.txt 6.6. Ch ươ ng trình tìm m ộ t xâu trong m ộ t t ұ p tin -Minh h ọ a các c ấ u trúc if then fi, while do done. -T ậ p tin timxau.sh #!/bin/sh echo 'Chuong trinh tim xau $1 trong tap tin $2' { wordlen=`expr length '$1'` # Do dai tu can tim while read textline do textlen=`expr length '$textline'` # Do dai cua dong vua doc end=$(($textlen - wordlen + 1' index=1 while [ $index -le $end ] do temp=`expr substr '$textline' $index $wordlen if [ '$temp' = $1 ] then echo 'Tim thay $1 tai dong $textline' break fi index=$(($index + 1)) done done }<$2 exit 0 -Ch ạ y ch ươ ng trình : chmod a+x timxau.sh ./timxau abc bai1.txt
```

```
#./hello
```

## L ұ p trình C &amp; C ++

Trình biên d ị ch GNU là công c ụ phát tri ể n thông d ụ ng nh ấ t s ẵ n có trong h ệ đ i ề u hành Linux, đượ c dùng để biên d ị ch các kernael c ủ a h ệ đ i ề u hành. Ngoài ra gcc cung c ấ p các th ư vi ệ n và các t ậ p tin Header c ầ n thi ế t để biên d ị ch và ch ạ y các ch ươ ng trình c ủ a ng ườ i dùng.

Các ch ươ ng trình C th ườ ng có ph ầ n tên m ở r ộ ng là .c

Các ch ươ ng trình C ++ th ườ ng có ph ầ n tên m ở r ộ ng là .cc các ho ặ c .C

Để biên d ị ch và th ự c thi m ộ t ch ươ ng trình C b ạ n làm nh ư sau :

1.  So ạ n th ả o ch ươ ng trình. L ư u t ậ p tin v ớ i tên và ph ầ n m ở r ộ ng thích h ợ p.

## # vi example.c

2. Thoát vi, t ừ d ấ u nh ắ c h ệ th ố ng b ạ n gõ l ệ nh :
3.  N ế u  có  l ỗ i,  trình  biên  d ị ch  s ẽ thông  báo  s ố th ứ t ự dòng  l ệ nh l ỗ i.  N ế u  biên  d ị ch thành công, để ch ạ y ch ươ ng trình gõ l ệ nh :

```
gcc   -o   filedestination   filesource
```

```
Cú pháp : #gcc   -o   hello   hello.c
```

## #./filedestination

Ví d ụ

L ư u ý cách dùng ./ tr ướ c tên ch ươ ng trình, ngh ĩ a là máy s ẽ ch ỉ tìm ki ế m ch ươ ng trình kh ả thi t ạ i th ư m ụ c hi ệ n hành.

Để d ị ch  cùng  m ộ t  lúc  nhi ề u  t ậ p  tin  ch ươ ng  trình  trong  th ư m ụ c  hi ệ n  hành,  b ạ n dùng l ệ nh : make ho ặ c make all

Sau đ ây là m ộ t s ố ch ươ ng trình ví d ụ :

## 1.  Ch ươ ng trình hello.c

```
#include <stdio.h> #include <math.h> main() { int i; double a; for(i=1;i<11;i++) { a=i*1.0; printf("%2d. %3d %4d %7.5f\n",i,i*i,i*i*i); }
```

```
}
```

## 2. Ch ươ ng trình sample.c

```
#include <stdio.h> void printnum ( int ); /* Khai b ỏ o hàm */ void printchar ( char ); /* Khai b ỏ o hàm */ main () { double tmp; /* Khai b ỏ o bi?n toàn c?c */ tmp = 1.234; printf ("%f\n",tmp); /* In gi ỏ tr? c?a bi?n toàn c?c tmp */ printnum (5); /* In gi ỏ tr? s? 5 */ printf ("%f\n",tmp); /* In gi ỏ tr? c?a bi?n toàn c?c tmp */ printchar ('k'); /* in ký t? k */ printf ("%f\n",tmp); /* In gi ỏ tr? c?a bi?n toàn c?c tmp */ } /* é?nh nghia hàm dó khai b ỏ o ? tr ờ n */ /* Khai b ỏ o cú t? kho ỏ void nghia là hàm kh ụ ng tr? v? m?t gi ỏ tr? */ void printnum (int inputnum) { int tmp; tmp = inputnum; printf ("%d \n",tmp); } void printchar (char inputchar) { char tmp; tmp = inputchar; printf ("%c \n",tmp); }
```

## 8.1. Gi ớ i thi Ӌ u

Ti ế n trình là m ộ t môi tr ườ ng th ự c hi ệ n, bao g ồ m m ộ t phân đ o ạ n l ệ nh và m ộ t phân đ o ạ n d ữ li ệ u. C ầ n phân bi ệ t v ớ i khái ni ệ m ch ươ ng trình ch ỉ g ồ m t ậ p h ợ p l ệ nh.

Trên h ệ đ i ề u hành Linux, ti ế n trình đượ c nh ậ n bi ế t thông qua s ố hi ệ u c ủ a ti ế n trình, g ọ i là pid . C ũ ng nh ư đố i v ớ i user, nó có th ể n ằ m trong nhóm. Vì th ế để phân bi ệ t ta nh ậ n bi ế t qua s ố hi ệ u nhóm g ọ i là pgrp . M ộ t s ố hàm c ủ a C cho phép l ấ y đượ c nh ữ ng thông s ố này:

int getpid() /* tr ả v ề giá tr ị int là pid c ủ a ti ế n trình hi ệ n t ạ

i*/

int getppid()

/*tr ả v ề giá tr ị int là pid c ủ a ti ế n trình cha c ủ a ti ế n trình hi ệ n t ạ i */

int getpgrp() /* tr ả v ề giá tr ị int là s ố hi ệ u c ủ a nhóm ti ế

n trình*/

int setpgrp() /*tr v giá tr int là s hi u nhóm ti n trình m i t

ả ề ị ố ệ ế ớ ạ

o ra*/

Ví d ụ :

L ệ nh :

printf("Toi la tien trinh %d thuoc nhom %d",getpid(),getgrp());

K ế t qu ả s ẽ

là: Toi là tien trinh 235 thuoc nhom 231

## 8.1.1. T ҥ o m ộ t ti Ӄ n trình - l Ӌ nh fork

ạ ộ ế ị ả ạ ế ấ u int fork() t o ra m t  ti n trình con. Giá tr tr l i  là  0 cho ti n trình con và d hi ệ u pid cho ti ế n trình cha. Giá tr ị s ẽ là -1 n ế u không t ạ o đượ c ti ế n trình m ớ i.

Theo nguyên t ắ c c ơ b ả n c ủ a h ệ th ố ng, ti ế n trình con và cha s ẽ có cùng đ o ạ n mã. Đ o ạ n d ữ li ệ u c ủ a ti ế n trình m ớ i là m ộ t b ả n sao chép chính xác đ o ạ n d ữ li ệ u c ủ a ti ế n trình cha. Tuy nhiên ti ế n trình con v ẫ n khác ti ế n trình cha ở pid, th ờ i gian x ử lý, ...

## 8.1.2. D ӯ ng m ộ t ti Ӄ n trình

L ệ nh kill c ủ a Shell có th ể dùng để ch ấ m d ứ t ho ạ t độ ng c ủ a m ộ t ti ế n trình. ví d ụ nh ư khi mu ố n d ừ ng ti ế n trình 234 ta dùng l ệ nh: kill 234

C c ũ ng có l ệ nh kill  nh ư sau:

int kill(pid, sig);

int pid; là d ấ u hi ệ u nh ậ n bi ế t c ủ a m ộ t ti ế n trình.

int sig;

h ằ ng tín hi ệ u giao ti ế p ti ế n trình.

## QU Ҧ N LÝ TI ӂ N TRÌNH

## 8.1.3. Giao ti Ӄ p gi ӳ a các ti Ӄ n trình

Vi ệ c giao ti ế p gi ữ a các ti ế n trình đượ c th ự c hi ệ n thông qua các tín hi ệ u chu ẫ n c ủ a h ệ th ố ng. Tín hi ệ u là m ộ t s ự ng ắ t quãng logic đượ c g ử i đế n các ti ế n trình b ở i h ệ th ố ng để thông báo cho chúng v ề nh ữ ng s ự vi ệ c không bình th ườ ng trong môi tr ườ ng ho ạ t độ ng c ủ a chúng (nh ư l ỗ i b ộ nh ớ , l ỗ i vào ra). Nó c ũ ng cho phép các ti ế n trình liên l ạ c v ớ i nhau. M ộ t tín hi ệ u (tr ừ SIGKILL) có th ể đượ c xem xét theo ba cách khác nhau:

1. Ti ế n  trình  có  th ể đượ c  b ỏ qua:  Ví  d ụ ch ươ ng  trình  có  th ể b ỏ qua  s ự ng ắ t quãng c ủ a ng ườ i s ử d ụ ng h ệ th ố ng ( đ ó là s ự b ỏ qua khi m ộ t ti ế n trình đ ang đượ c s ử d ụ ng ở ph ầ n n ề n.
2. Ti ế n trình có th ể đượ c th ự c hi ệ n: Trong tr ườ ng h ợ p này, khi nh ậ n đượ c 1 tina sti ệ u, vi ệ c th ự c hi ệ n 1 ti ế n trình đượ c chuy ể n v ề m ộ t quy trình do ng ườ i s ử d ụ ng xác đị nh tr ướ c, sau đ ó tr ở l ạ i n ơ i nó b ị ng ắ t.
3.  L ỗ i có th ể đượ c ti ế n trình tr ả v ề sau khi nh ậ n đượ c tín hi ệ u này.

D ướ i đ ây là m ộ t s ố tín hi ệ u th ườ ng g ặ p:

| SIGHUP                                                                                                                                                                                             | Tín hi ệ u này đượ c phát đế n các ti ế n trình vào lúc cu ố i khi mà nó t ự ng ắ t. Nó c ũ ng đượ c phát đế nm ọ i ti ế n trình có ti ế n trình chính t ự ng ắ t.   |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Tín hi ệ u này đượ c phát đế n các ti ế n trình khi ta ra l ệ nh ng ắ t.                                                                                                                           | SIGINT                                                                                                                                                               |
| T ươ ng t ự nh ư trên khi ta gõ vào ^D.                                                                                                                                                            | SIGQUIT                                                                                                                                                              |
| L ệ nh không h ợ p l ệ , tín hi ệ u đượ c phát ra khi phát hi ệ n 1 l ệ nh không đ úng ở c ấ p độ v ậ t lý (ví d ụ nh ư 1 ti ế n trình th ự c hi ệ nm ộ t l ệ nh mà máy tính chông có l ệ nh này). | SIGILL                                                                                                                                                               |
| Tín hi ệ u đượ c phát ra saum ỗ i l ệ nh trong tr ườ ng h ợ p ti ế n trình có s ử d ụ ng l ệ nh ptrace().                                                                                          | SIGTRAP                                                                                                                                                              |
| B ẫ y đượ c phát khi có các v ấ n đề v ề v ậ t lý.                                                                                                                                                 | SIGIOT                                                                                                                                                               |
| B ẫ y c ủ a l ệ nh phát, đượ c phát ra khi có l ỗ i v ậ t lý trong khi th ự c hi ệ n.                                                                                                              | SIGEMT                                                                                                                                                               |
| Đượ c phát ra khi có l ỗ i v ề tính toán nh ư m ộ t s ố có d ấ u ph ẩ y n ố i có đị nh d ạ ng không h ợ p lý. G ầ n nh ư luôn ch ỉ ra l ỗ i khi l ậ p trình.                                       | SIGFPE                                                                                                                                                               |
| Trang b ị để k ế t thúc ti ế n trình. Không th ể b ỏ qua ho ặ c c ắ t tín hi ệ u này.                                                                                                              | SIGKILL                                                                                                                                                              |
| Đượ c phát khi g ặ p l ỗ i trên bus.                                                                                                                                                               | SIGBUS                                                                                                                                                               |
| Đượ c phát ra khi g ặ p l ỗ i trên phân đ o ạ n s ự truy c ậ p d ữ li ệ u bên ngoài phân đ o ạ n d ữ li ệ u đượ c c ấ p phát cho ti ế n trình.                                                     | SYSGEGV                                                                                                                                                              |

| Đố i s ố không đ úng cho h ệ th ố ng g ọ i.                                                                                                                      | SIGSYS   |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| Vi ế t trênm ộ t ố ng d ẫ n khôngm ở để đọ c.                                                                                                                    | SIGPIPE  |
| Phát ra khi đồ ng h ồ c ủ am ộ t ti ế n trình ng ừ ng l ạ i. Đồ ng h ồ đượ c ho ạ t độ ng b ằ ng l ệ nh alrm().                                                  | SIGALRM  |
| Đượ c phát ra khim ộ t ti ế n trình k ế t thúc bình th ườ ng. C ũ ng có th ể dùng để d ừ ng 1 h ệ th ố ng để k ế t thúc t ấ t c ả các ti ế n trình ho ạ t độ ng. | SIGTERM  |

## 8.1.4. Liên l ҥ c gi ӳ a hai ti Ӄ n trình

T ừ m ộ t ch ươ ng trình đơ n gi ả n d ướ i đ ây s ử d ụ ng các l ệ nh phát và nh ậ n tín hi ệ u, sau đ ó giúp liên l ạ c gi ữ a hai ti ế n trình.

N ộ i dung c ủ a ví d ụ là s ự liên l ạ c gi ữ a m ộ t ti ế n trình cha và m ộ t ti ế n trình con thông qua các tín hi ệ u đ ã đượ c trình bày ph ầ n tr ướ c.

```
#include <errno. h> #include <signal. h> void fils_atc() { printf(" Tien trinh bi loai bo !!!\n"); kill(getpid(), SIGINT); } /***********************************/ void fils() { signal(SIGUSR1, fils_atc); printf(" Hinh thanh tien trinh moi. Nhung chuan bi loai bo tien trinh nay !!\n"); while(1); } /******************************/ main() { int ppid, pid; if ((pid = fork())==0) fils(); else { sleep(3); printf(" Chap nhan !! Tien trinh se bi loai bo.\n"); kill(pid, SIGUSR1); } }
```

Trong ví d ụ trên, ti ế n trình con có s ử d ụ ng hàm signal(SIGUSR1, fils\_atc). Hàm này có tác d ụ ng m ỗ i khi ti ế n trình con nh ậ n đượ c tín hi ệ u SIGUSR1 thì hàm fils\_atc() s ẽ đượ c th ự c thi.

Nh ư v ậ y ở ví d ụ trên m ộ t ti ế n trình con đ ã đượ c t ạ o ra nh ư ng nó l ạ i không mu ố n ti ế p t ụ c t ồ n t ạ i. Do v ậ y sau khi t ạ m d ừ ng l ạ i sleep(3), ti ế n trình cha đ ã g ở i đế n cho ti ế n trình con m ộ t tín hi ệ u là SIGUSR1 b ằ ng l ệ nh:

## kill(pid, SIGUSR1);

ở ti ế n trình con, tín hi ệ u SIGUSR1 đ ã đượ c gán v ớ i hàm fils\_atc(). Hàm này ra m ộ t thông báo báo hi ệ u ti ế n trình này s ắ p ch ế t r ồ i t ự g ở i đế n chính mình (ti ế n trình con) tín hi ệ u SIGINT, tín hi ệ u ng ắ t ti ế n trình. Và ti ế n trình con đ ã ch ế t.

## kill(getpid(), SIGINT);

M ộ t s ố nh ượ c đ i ể m khi liên l ạ c tr ự c ti ế p b ằ ng tín hi ệ u:

-  M ộ t tín hi ệ u có th ể b ị b ỏ qua, k ế t thúc m ộ t ti ế n trình ho ặ c b ị ch ặ n l ạ i. Đ ó là lý do chính đư a ra các tín hi ệ u không thích ứ ng đượ c để ti ế n hành liên l ạ c gi ữ a các ti ế n trình. M ộ t  thông đ i ệ p đ i ệ p d ướ i  hình th ứ c tín hi ệ u có th ể s ẽ b ị m ấ t  n ế u nó đượ c nh ậ n lúc lo ạ i tín hi ệ u này t ạ m th ờ i b ị b ỏ qua.
-  M ộ t  v ấ n đề khác là các tín hi ệ u có quy ề n r ấ t  l ớ n, khi đế n chúng làm ng ắ t  quãng công vi ệ c hi ệ n t ạ i. Ví d ụ vi ệ c nh ậ n m ộ t tín hi ệ u trong khi ti ế n trình đ ang đợ i m ộ t s ự ki ệ n (mà có th ể đế n khi s ử d ụ ng các l ệ nh open(), read(), ...) làm cho vi ệ c th ự c thi hàm b ị ch ệ ch h ướ ng. Khi tr ở l ạ i, l ệ nh chính b ị ng ắ t g ở i l ạ i m ộ t thông đ i ệ p báo l ỗ i mà hoàn toàn không x ử lý đượ c.

Ngoài vi ệ c liên l ạ c tr ự c ti ế p nh ư ở ví d ụ trên, còn cho phép m ộ t ph ươ ng pháp liên l ạ c gi ữ a các ti ế n trình  khác, đ ó là liên l ạ c qua " đườ ng ố ng".

## 8.2. L ұ p trình đ a ti Ӄ n trình

## 8.2.1. ng d n liên l

## ӕ ү ҥ c

ố ng d ẫ n là m ộ t c ơ ch ế c ơ b ả n để liên l ạ c gián ti ế p gi ữ a các ti ế n trình. Đ ó là các file đặ c bi ệ t (FIFO), ở đ ó các thông tin đượ c truy ề n đ i 1 đầ u và thoát ra ở m ộ t đầ u khác.

M ộ t s ố đặ c đ i ể m c ủ a " ố ng d ẫ n":

- ố ẫ ỉ ấ ạ ờ ỉ ồ ạ ờ ự ệ ủ
- -Các ng d n ch mang tính ch t t m th i, ch t n t i trong th i gian th c hi n c a m ộ t ti ế n trình t ạ o ra nó.
- -Mu n t o ra m t ng d n ph i b t u b ng m t l nh c bi t: pipe() .
- ố ạ ộ ố ẫ ả ắ đầ ằ ộ ệ đặ ệ
- -Nhi ề u ti ế n trình có th ể vi ế t và đọ c trên cùng m ộ t ố ng d ẫ n. Tuy nhiên, không có m ộ t c ơ ch ế nào để phân bi ệ t thông tin cho các ti ế n trình ở đầ u ra.
- -Dung l ượ ng ố ng d ẫ n b ị h ạ n ch ế (kho ả ng 4KB). Do đ ó khi chúng ta c ố g ắ ng vi ế t khi ố ng d ẫ n b ị đầ y thì s ẽ g ặ p ph ả i tr ườ ng h ợ p t ắ c ngh ẽ n.

- -Các ti ế n trình liên l ạ c qua ố ng d ẫ n ph ả i có m ố i quan h ệ h ọ hàng và các ố ng d ẫ n n ố i ph ả i đượ c m ở tr ướ c khi t ạ o ra các ti ế n trình con.
- -Không th ể t ự thay đổ i v ị trí thông tin trong ố ng.

## 8.2.2. Thao tác v ớ i " ӕ ng d ү n liên l ҥ c"

T ạ o m ộ t ố ng d ẫ n: int p\_desc[2]; int pipe(p\_desc); Giá tr ị tr ả v ề là 0 n ế u thành công, -1 n ế u th ấ t b ạ i. p\_desc[0] : ch ứ a các s ố hi ệ u mô t ả nh ờ đ ó có th ể đọ c trong ố ng d ẫ n. p\_desc[1] : ch ứ a các s ố hi ệ u mô t ả nh ờ đ ó có th ể vi ế t trong ố ng d ẫ n.

Nh ư v ậ y vi ệ c vi ế t trong p\_desc[1] là để truy ề n d ữ li ệ u trong ố ng và vi ệ c đọ c trong p\_desc[0] để nh ậ n chúng.

```
Ví d ụ : #include <errno. h> #include <signal. h> main() { int i,ret, p_desc[2]; char c; pipe(p_desc); write(p_desc[1], "AB", 2); for (i=1; i<=3,i ++) { ret=read(p_desc[0], &c, 1); if (ret == 1) printf(" Gia tri:  %c\n",c); else perror("Loi ong dan rong"); } }
```

Ví d ụ trên ch ỉ ra r ằ ng ta có th ể truy ề n và nh ậ n thông tin trên ố ng d ẫ n. Chúng ta đ ã dùng hàm read() và write() để vi ế t (truy ề n) và đọ c (nh ậ n) trên ố ng d ẫ n.

## 8.2.3. Liên l ҥ c gi ӳ a ti Ӄ n trình cha và ti Ӄ n trình con

Trong ví d ụ d ướ i đ ây, m ộ t ti ế n trình t ạ o ra m ộ t ố ng d ẫ n, t ạ o ra m ộ t ti ế n trình con, vi ế t m ộ t v ă n b ả n vào ố ng d ẫ n.Ti ế n trình con th ừ a h ưở ng ố ng d ẫ n và các ký hi ệ u mô t ả c ủ a ố ng d ẫ n, th ự c hi ệ n đọ c trong ố ng d ẫ n:

```
#include <errno. h> #include <stdio. h> void code_fils(int number)   { int fd, nread; char texte[100];
```

```
fd=number; printf(" So hieu mo ta la %d\n",fd); switch (nread=read(fd, texte, sizeof(texte))) { case -1: perror("Loi doc."); case 0: perror("EOF"); default: printf("Van ban nhan duoc co %d ky tu: %s\n",fd, texte); } } main()   { int fd[2]; char chaine[10]; if (pipe(fd)==-1) { perror("Loi khoi tao pipe."); exit(1); } switch (fork())   { case -1: perror(" Loi khoi tao tien trinh."); break; case 0: if (close(fd[1])==-1) perror(" Error."); code_fils(fd[0]); exit(0); } close(fd[0]); if (write(fd[1]),"hello",6)==-1) perror("Loi truyen."); }
```

## K ế t qu ả ch ươ ng trình:

```
So hieu mo ta la: 5 Van ban nhan duoc co 6 ky tu: hello
```

Chú ý r ằ ng, ti ế n trình con đọ c trong ố ng d ẫ n mà không vi ế t ở đ ó nên nó b ắ t đầ u b ằ ng cách đ óng ph ầ n vi ế t fd[1] để ti ế t ki ệ m các tín hi ệ u mô t ả c ủ a t ổ h ợ p. T ươ ng t ự , vì ti ế n trình cha ch ỉ s ử d ụ ng ph ầ n vi ế t nên nó đ óng ph ầ n đọ c l ạ i (fd[0]). Sau đ ó ti ế n trình cha vi ế t vào ố ng d ẫ n 6 ký t ự và ti ế n trình con đ ã đọ c chúng.

## Bài 9 L ұ p trình m ҥ ng TCP/IP

## 9.1. L ұ p trình client /server theo giao th ứ c TCP/IP

- Ch ươ ng trình tcpClient.c
- /* Chuong trinh tcpClient.c */

```
/* Khai báo các file th ư vi ệ n c ầ n thi ế t để g ọ i hàm socket*/ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> /*gethostbyname*/ #include <arpa/inet.h> #include <netdb.h> #include <stdio.h> #include <unistd.h> /* close */ #define SERVER_PORT 1500 #define MAX_MSG 100 int main (int argc, char *argv[]) { /* Kh ở i t ạ o các bi ế n dùng trong ch ươ ng trình */ int sd, rc, i; struct sockaddr_in localAddr, servAddr; struct hostent *h; if(argc < 3) { printf("usage: %s <IPserver> <data1> <data2> ... <dataN>\n",argv[0]); exit(1); } /* Hàm gethostbyname() l ấ y v ề đị a ch ỉ IP theo tên nh ậ p vào trong t ậ p tin /etc/hosts */ h = gethostbyname(argv[1]); if(h==NULL) { printf("%s: unknown host '%s'\n",argv[0],argv[1]); exit(1); } servAddr.sin_family = h->h_addrtype; memcpy((char *) &servAddr.sin_addr.s_addr, h->h_addr_list[0], h->h_length); servAddr.sin_port = htons(SERVER_PORT); /* Gán các giá tr ị cho đố i t ượ ng socket. T ạ o socket cho máy Client.  L ư u l ạ i s ố mô t ả socket */ sd = socket(AF_INET, SOCK_STREAM, 0); if(sd<0) { perror("cannot open socket "); exit(1); } /* Đặ t tên socket cho ch ươ ng trình Client Gán đị a ch ỉ k ế t n ố i cho socket theo giao th ứ c Internet */ localAddr.sin_family = AF_INET; localAddr.sin_addr.s_addr = htonl(INADDR_ANY); localAddr.sin_port = htons(0); /* Hàm htons() dùng để chuy ể n đổ i tr ậ t t ự byte c ủ a s ố nguyên tr ướ c khi g ở i đ i - do h ệ th ố ng s ử d ụ ng c ơ ch ế giao ti ế p TCP/IP */ /* Ràng bu ộ c tên v ớ i socket */
```

```
rc = bind(sd, (struct sockaddr *) &localAddr, sizeof(localAddr)); if(rc<0) { printf("%s: cannot bind port TCP %u\n",argv[0],SERVER_PORT); perror("error "); exit(1); } /* Th ự c hi ệ n k ế t n ố i đế n server theo tên/ đị a ch ỉ nh ậ p vào t ừ dòng l ệ nh */ rc = connect(sd, (struct sockaddr *) &servAddr, sizeof(servAddr)); if(rc<0) { perror("cannot connect "); exit(1); } /* Sau khi socket đ ã k ế t n ố i, th ự c hi ệ n g ử i các d ữ li ệ u đế n ch ươ ng trình Server */ for(i=2;i<argc;i++) { rc = send(sd, argv[i], strlen(argv[i]) + 1, 0); if(rc<0) { perror("cannot send data "); close(sd); exit(1); } /* if */ printf("%s: data%u sent (%s)\n",argv[0],i-1,argv[i]); } /* for */ return 0; }/*main*/ · Ch ươ ng trình tcpServer.c /* Chuong trinh tcpServer.c */ /* Khai báo các file th ư vi ệ n c ầ n thi ế t để g ọ i hàm socket*/ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> #include <arpa/inet.h> #include <netdb.h> #include <stdio.h> #include <unistd.h> /* close */ #define SUCCESS 0 #define ERROR   1 #define END_LINE 0x0 #define SERVER_PORT 1500 #define MAX_MSG 100 /* function readline */ int read_line();
```

```
int main (int argc, char *argv[]) { int sd, newSd, cliLen; struct sockaddr_in cliAddr, servAddr; char line[MAX_MSG]; /* Gán các giá tr ị cho đố i t ượ ng socket. T ạ o socket cho máy Server. L ư u l ạ i s ố mô t ả socket */ sd = socket(AF_INET, SOCK_STREAM, 0); if(sd<0) { perror("cannot open socket "); return ERROR; } /* Đặ t tên socket cho ch ươ ng trình Server Gán đị a ch ỉ k ế t n ố i cho socket theo giao th ứ c Internet */ servAddr.sin_family = AF_INET; servAddr.sin_addr.s_addr = htonl(INADDR_ANY); servAddr.sin_port = htons(SERVER_PORT); if(bind(sd, (struct sockaddr *) &servAddr, sizeof(servAddr))<0) { perror("cannot bind port "); return ERROR; } /* T ạ o hàng đợ i l ắ ng nghe k ế t n ố i c ủ a client Cho phép hàng đợ i nh ậ n t ố i đ a 5 k ế t n ố i */ listen(sd,5); /* L ặ p liên t ụ c ch ờ và lxy k ế t n ố i c ủ a client */ while(1) { printf("%s: waiting for data on port TCP %u\n",argv[0],SERVER_PORT); cliLen = sizeof(cliAddr); /* Ch ấ p nh ậ n k ế t n ố i */ newSd = accept(sd, (struct sockaddr *) &cliAddr, &cliLen); if(newSd<0) { perror("cannot accept connection "); return ERROR; } /* init line */ memset(line,0x0,MAX_MSG); /* Đọ c d ữ li ệ u do Client g ở i đế n - x ử lý d ữ li ệ u nh ậ n đượ c */ while(read_line(newSd,line)!=ERROR) { printf("%s: received from %s:TCP%d : %s\n", argv[0], inet_ntoa(cliAddr.sin_addr), ntohs(cliAddr.sin_port), line); /* init line */ memset(line,0x0,MAX_MSG);
```

```
} /* while(read_line) */ } /* while (1) */ } /* WARNING */ /* this function is experimental. I don't know yet if it works  */ /* correctly or not. Use Steven's readline() function to have  something robust.*/ /* rcv_line is my function readline(). Data is read from the socket when */ /* needed, but not byte after bytes. All the received data is read.      */ /* This means only one call to recv(), instead of one call for  each received byte. */ /* You can set END_CHAR to whatever means endofline for you. (0x0A is \n)*/ /* read_lin returns the number of bytes returned in line_to_return       */ /* Hàm có ch ứ c n ă ng đọ c d ữ li ệ u t ừ socket */ int read_line(int newSd, char *line_to_return) { static int rcv_ptr=0; static char rcv_msg[MAX_MSG]; static int n; int offset; offset=0; while(1) { if(rcv_ptr==0) { /* read data from socket */ memset(rcv_msg,0x0,MAX_MSG); /* init buffer */ n = recv(newSd, rcv_msg, MAX_MSG, 0); /* wait for data */ if (n<0) { perror(" cannot receive data "); return ERROR; } else if (n==0) { printf(" connection closed by client\n"); close(newSd); return ERROR; } } /* if new data read on socket  OR if another line is still in buffer */ /* copy line into 'line_to_return' */ while(*(rcv_msg+rcv_ptr)!=END_LINE && rcv_ptr<n) { memcpy(line_to_return+offset,rcv_msg+rcv_ptr,1); offset++; rcv_ptr++; } /* end of line + end of buffer => return line */ if(rcv_ptr==n-1) { /* set last byte to END_LINE */ *(line_to_return+offset)=END_LINE; rcv_ptr=0; return ++offset; }
```

```
/* end of line but still some data in buffer => return line */ if(rcv_ptr <n-1) { /* set last byte to END_LINE */ *(line_to_return+offset)=END_LINE; rcv_ptr++; return ++offset; } /* end of buffer but line is not ended => */ /*  wait for more data to arrive on socket */ if(rcv_ptr == n) { rcv_ptr = 0; } } /* while */ } /*main*/
```

## 9.2. L ұ p trình client /server theo giao th ứ c UDP/IP

## · Ch ươ ng trình udpClient.c

```
/* udpClient.c */ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> #include <arpa/inet.h> #include <netdb.h> #include <stdio.h> #include <unistd.h> #include <string.h> /* memset() */ #include <sys/time.h> /* select() */ #define REMOTE_SERVER_PORT 1500 #define MAX_MSG 100 int main(int argc, char *argv[]) { int sd, rc, i; struct sockaddr_in cliAddr, remoteServAddr; struct hostent *h; /* check command line args */ if(argc<3) { printf( "usage : %s <server> <data1> ... <dataN> \n", argv[0]); exit(1); } /* get server IP address (no check if input is IP address or DNS name */ h = gethostbyname(argv[1]); if(h==NULL) { printf("%s: unknown host '%s' \n", argv[0], argv[1]); exit(1); }
```

```
printf("%s: sending data to '%s' (IP : %s) \n", argv[0], h->h_name, inet_ntoa(*(struct in_addr *)h->h_addr_list[0])); remoteServAddr.sin_family = h->h_addrtype; memcpy((char *) &remoteServAddr.sin_addr.s_addr, h->h_addr_list[0], h->h_length); remoteServAddr.sin_port = htons(REMOTE_SERVER_PORT); /* socket creation */ sd = socket(AF_INET,SOCK_DGRAM,0); if(sd<0) { printf("%s: cannot open socket \n",argv[0]); exit(1); } /* bind any port */ cliAddr.sin_family = AF_INET; cliAddr.sin_addr.s_addr = htonl(INADDR_ANY); cliAddr.sin_port = htons(0); rc = bind(sd, (struct sockaddr *) &cliAddr, sizeof(cliAddr)); if(rc<0) { printf("%s: cannot bind port\n", argv[0]); exit(1); } /* send data */ for(i=2;i<argc;i++) { rc = sendto(sd, argv[i], strlen(argv[i])+1, 0, (struct sockaddr *) &remoteServAddr, sizeof(remoteServAddr)); if(rc<0) { printf("%s: cannot send data %d \n",argv[0],i-1); close(sd); exit(1); } } return 1; } · Ch ươ ng trình udpServer.c /* udpServer.c */ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> #include <arpa/inet.h> #include <netdb.h> #include <stdio.h> #include <unistd.h> /* close() */
```

```
#include <string.h> /* memset() */ #define LOCAL_SERVER_PORT 1500 #define MAX_MSG 100 int main(int argc, char *argv[]) { int sd, rc, n, cliLen; struct sockaddr_in cliAddr, servAddr; char msg[MAX_MSG]; /* T ạ o socket trên máy Server Đặ t tên cho socket c ủ a ch ươ ng trình Server */ sd=socket(AF_INET, SOCK_DGRAM, 0); if(sd<0) { printf("%s: cannot open socket \n",argv[0]); exit(1); } /* bind local server port - ràng bu ộ c tên v ớ i socket */ servAddr.sin_family = AF_INET; servAddr.sin_addr.s_addr = htonl(INADDR_ANY); servAddr.sin_port = htons(LOCAL_SERVER_PORT); rc = bind (sd, (struct sockaddr *) &servAddr,sizeof(servAddr)); if(rc<0) { printf("%s: cannot bind port number %d \n",  argv[0], LOCAL_SERVER_PORT); exit(1); } printf("%s: waiting for data on port UDP %u\n", argv[0],LOCAL_SERVER_PORT); /* Th ự c hi ệ n vòng l ặ p vô h ạ n trên Server để ch ờ và x ử lý k ế t n ố i đế n t ừ máy client */ while(1) { /* Kh ở i t ạ o b ộ đệ m */ memset(msg,0x0,MAX_MSG); /* Nh ậ n d ữ li ệ u g ở i đế n t ừ client */ cliLen = sizeof(cliAddr); n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) &cliAddr, &cliLen); if(n<0) { printf("%s: cannot receive data \n",argv[0]); continue; } /* In d ữ li ệ u nh ậ n đượ c */ printf("%s: from %s:UDP%u : %s \n",  argv[0],inet_ntoa(cliAddr.sin_addr), ntohs(cliAddr.sin_port),msg); } /*while*/ return 0; }
```

## Bài 10 D Ị CH V Ụ TRUY Ề N FILE FTP

FTP (File Transfer Protocol) là d ị ch v ụ cho phép truy ề n các t ậ p tin gi ữ a hai máy tính Client và Server, qu ả n lý các th ư m ụ c và truy c ậ p vào th ư tín đ i ệ n t ử . FTP không đượ c thi ế t l ậ p để truy c ậ p vào m ộ t máy khác và ch ạ y các ch ươ ng trình ở máy đ ó, ch ỉ dùng cho vi ệ c truy ề n t ậ p tin.

## Để k ế t n ố i FTP, gõ l ệ nh sau : ftp &lt;IPAddressServer&gt;

| L Ӌ nh ng ườ i dùng FTP   | Mô t ҧ                                                                         |
|---------------------------|--------------------------------------------------------------------------------|
| ascii                     | Chuy ể n sang ch ế độ truy ề n ascii                                           |
| bell âm                   | thanh c ủ a ch ươ ng trình sau khi truy ề nm ỗ i t ậ p tin                     |
| binary                    | Chuy ể n sang ch ế độ truy ề n nh ị phân                                       |
| cd                        | directory Chuy ể n đổ i th ư m ụ c hi ệ n hành trên server                     |
| cdup Lùi                  | th ư m ụ c hi ệ n hành v ề m ộ t c ấ p tr ướ c đ ó                             |
| close Hu                  | ỷ k ế t n ố i                                                                  |
| delete filename           | Xoám ộ t t ậ p tin trên server                                                 |
| dir directory             | Hi ể n th ị th ư m ụ c directory c ủ a server                                  |
| get filename              | Truy ề n t ậ p tin trên server v ề máy c ụ c b ộ                               |
| hash Hi                   | ể n th ị /làmm ấ t d ấ u # chom ỗ i kh ố i các ký t ự đ ã truy ề n đượ c       |
| help Hi                   | ể n th ị các tr ợ giúp                                                         |
| lcd directory             | Chuy ể n đổ i th ư m ụ c hi ệ n hành trên máy c ụ c b ộ                        |
| ls directory              | Xem danh sách các t ậ p tin trong th ư m ụ c directory trên Server             |
| mdelete files             | Xóa nhi ề u t ậ p tin trên máy Server                                          |
| mdir directories          | Li ệ t kê các t ậ p tin trong nhi ề u th ư m ụ c trên máy Server               |
| mget files T c            | ả i nhi ề u t ậ p tin trên máy Server v ề th ư m ụ c hi ệ n hành c ủ a ụ c b ộ |
| mkdir < directory > T     | ạ o th ư m ụ c trên máy Server                                                 |
| mput files                | G ử im ộ t s ố t ậ p tin t ừ máy c ụ c b ộ lên máy Server                      |
| open host                 | K ế t n ố i v ớ i Server host t ừ xa                                           |
| put filename              | Truy ề n t ậ p tin t ừ máy c ụ c b ộ lên máy Server                            |
| pwd                       | Hi ể n th ị th ư m ụ c hi ệ n hành trên server                                 |

| status   | Hi ể n th ị tr ạ ng thái c ủ a ftp                 |
|----------|----------------------------------------------------|
| rename   | Đổ i tên file1 trên máy Server thành file2         |
| quote    | Cung c ấ pm ộ t l ệ nh FTPm ộ t cách tr ự c ti ế p |
| quit     | Ch ấ md ứ t k ế t n ố i và thoát kh ỏ i ftp        |
| ?        | Hi ể n th ị danh sách l ệ nh                       |

Khi  truy  c ậ p  vào  h ệ th ố ng,  n ế u  ch ư a  có  account,  ng ườ i  dùng  có  th ể login  v ớ i account đặ c bi ệ t là anonymous , không có m ậ t kh ẩ u.

C:\&gt;ftp ↵

## Th ӵ c hành

| C:\>ftp                              | Kh i ng ftp t th m c hi n hành C:\                                                             |
|--------------------------------------|------------------------------------------------------------------------------------------------|
| (to) : 200.201.202.180 user : user01 | Nh ậ p vào tên user                                                                            |
| Password :                           | Nh ậ p vào m ậ t kh ẩ u t ươ ng ứ ng                                                           |
| ftp> dir                             | Xem n ộ i dung th ư m ụ c                                                                      |
| ftp> ?                               | Xem n ộ i dung các l ệ nh c ủ a ftp                                                            |
| ftp>put autoexec.bat autoexec.dos    | Chuy ể n t ậ p tin t ừ Client lên Server v ớ i tên m ớ i là autoexec.dos                       |
| ftp> ls                              | Xem k ế t qu ả truy ề n file                                                                   |
| ftp>get autoexec.dos LINUX.TXT       | L ấ y t ậ p tin autoexec.dos trên Server v ề Client v ớ i tên m ớ i là LINUX.TXT ấ ậ ề         |
| ftp>mget autoexec.dos                | L y t p tin autoexec.dos trên Server v Client th ư m ụ c C:\                                   |
| ftp>cd /home/user01                  | Chuy ể n đế n th ư m ụ c hi ệ n hành là user01 là th ư m ụ c có toàn quy ề n c ủ a user user01 |
| ftp>mdir document                    | T ạ o trong th ư m ụ c user01 th ư m ụ c m ớ i có tên document                                 |
| ftp> help dir                        | Xem h ướ ng d ẫ n s ử d ụ ng l ệ nh dir                                                        |
| ftp>help get                         | Xem h ướ ng d ẫ n s ử d ụ ng l ệ nh get                                                        |
| ftp> quit                            | K ế t thúc phiên làm vi ệ c                                                                    |

Kh ở i độ ng  ftp t ừ th ư m ụ c hi ệ n hành C:\

## Bài 11 CÁC T Ậ P TIN C Ấ U HÌNH M Ạ NG

## 1. T ậ p tin /etc/hosts

# Do not remove the following line, or various programs # that require network functionality will fail. 127.0.0.1       localhost.localdomain   localhost 200.201.202.1   linuxsvr.dng.vn linuxsvr

## 2. T ậ p tin /etc/sysconfig/network

NETWORKING=yes FORWARD\_IPV4=false HOSTNAME=linuxsvr.edu.vn DOMAIN=edu.vn

GATEWAY=200.201.202.1

## 3. T ậ p tin /etc/sysconfig/network-scripts/ifcfg-eth0

DEVICE=eth0 BOOTPROTO=none ONBOOT=yes USERCTL=no PEERDNS=no TYPE=Ethernet IPADDR=200.201.202.1 NETMASK=255.255.255.0 NETWORK=200.201.202.0

BROADCAST=200.201.202.255

## 4. Ch ạ y ch ươ ng trình X- Windows h ỗ tr ợ c ấ u hình h ệ th ố ng :

redhat-config-network

## 5. Kh ở i độ ng l ạ i d ị ch v ụ m ạ ng

## [root@linuxsvr root]#/etc/init.d/network restart

Shutting down interface eth0:

[  OK  ]

Shutting down loopback interface:

[  OK  ]

Setting network parameters:

[  OK  ]

Bringing up loopback interface:

[  OK  ]

Bringing up interface eth0:

[  OK  ]

## 6. Ki ể m tra b ằ ng l ệ nh :

[root@linuxsvr root]# hostname linuxsvr.dng.vn

## 7. Xem thông tin v ề c ấ u hình thi ế t b ị m ạ ng

## [root@linuxsvr root] #ifconfig

eth0      Link encap:Ethernet  HWaddr 00:06:7B:02:71:21

inet addr:200.201.202.1  Bcast:200.201.202.255  Mask:255.255.255.0

UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

RX packets:2326 errors:0 dropped:0 overruns:0 frame:0

TX packets:70927 errors:0 dropped:0 overruns:0 carrier:0

collisions:0 txqueuelen:100

RX bytes:218392 (213.2 Kb)  TX bytes:6939053 (6.6 Mb)

Interrupt:9 Base address:0x4c00

## lo        Link encap:Local Loopback

inet addr:127.0.0.1  Mask:255.0.0.0

UP LOOPBACK RUNNING  MTU:16436  Metric:1

RX packets:933 errors:0 dropped:0 overruns:0 frame:0

TX packets:933 errors:0 dropped:0 overruns:0 carrier:0

collisions:0 txqueuelen:0

RX bytes:87261 (85.2 Kb)  TX bytes:87261 (85.2 Kb)

Hình 1. C ấ u hình d ị ch v ụ m ạ ng b ằ ng ti ệ n ích redhat-config-network.

<!-- image -->

## Bài 12 DNS

## C Ҩ U HÌNH D ӎ CH V Ө

## 12.1.  Các t ұ p tin c ҩ u hình d ӏ ch v ө DNS

## 12.1.1. T ậ p tin /etc/host.conf

order hosts,bind

## 12.1.2. T ậ p tin /etc/resolv.conf

:search dng.vn nameserver 200.201.202.1

## 12.1.3. T ậ p tin  /etc/named.conf

```
# named.conf - configuration for bind # Generated automatically by redhat-config-bind, alchemist et al. # Any changes not supported by redhat-config-bind should be put # in /etc/named.custom controls { inet 127.0.0.1 allow { localhost; } keys { rndckey; }; }; include "/etc/named.custom"; include "/etc/rndc.key"; zone  "0.0.127.in-addr.arpa" { type master; file  "0.0.127.in-addr.arpa.zone"; }; zone  "localhost" { type master; file  "localhost.zone"; }; zone  "dng.vn" { type master; file  "dng.vn.zone"; }; zone  "edu.vn" { type master; file  "edu.vn.zone"; };
```

## 12.1.4. T p tin /var/named/dng.vn.zone

## ậ

```
$TTL 86400 @       IN      SOA     dng.  root.localhost ( 1 ; serial 28800 ; refresh 7200 ; retry 604800 ; expire 86400 ; ttl ) IN      NS      200.201.202.1.
```

```
www IN      A       200.201.202.1 tankhoi01       IN      A       200.201.202.1 tankhoi02       IN      A       200.201.202.2
```

## 12.1.5. T ậ p tin /var/named/edu.vn.zone

```
$TTL 86400 @       IN      SOA     edu.  root.localhost ( 2 ; serial 28800 ; refresh 7200 ; retry 604800 ; expire 86400 ; ttl ) IN      NS      200.201.202.1. www IN      A       200.201.202.1 tankhoi01       IN      A       200.201.202.1 tankhoi02       IN      A       200.201.202.2
```

## 12.1.6. T ậ p tin /var/named/0.0.127.in-addr.arpa.zone

```
$TTL 86400 @       IN      SOA     localhost.      root.linuxsvr.dng.vn ( 36 ; serial 28800 ; refresh 7200 ; retry 604800 ; expire 86400 ; ttk ) @       IN      NS      localhost. 1       IN      PTR     localhost. 1       IN      PTR     www. 1       IN      PTR     tankhoi01. 2       IN      PTR     tankhoi02. 1       IN      PTR     www. 1       IN      PTR     tankhoi01. 2       IN      PTR     tankhoi02.
```

## 12.1.7. T ậ p tin  /var/named/localhost.zone

```
$TTL 86400 @       IN      SOA     @  root.localhost ( 1 ; serial 28800 ; refresh 7200 ; retry 604800 ; expire 86400 ; ttl ) IN      NS      localhost. @       IN      A       127.0.0.1
```

## 12.1.8. L ệ nh kh ở i độ ng d ị ch v ụ DNS

## /etc/init.d/named restart

## 12.2.  Các l Ӌ nh và ti Ӌ n ích h ỗ tr ӧ

## 12.2.1. L nh nslookup

## ệ

## #nslookup

Note:  nslookup is deprecated and may be removed from future releases. Consider using the `dig' or `host' programs instead.  Run nslookup with the `-sil[ent]' option to prevent this message from appearing.

&gt; www.dng.vn

Server:         200.201.202.1

Address:        200.201.202.1#53

Name:   www.dng.vn

Address: 200.201.202.1

&gt; tankhoi02.edu.vn

Server:         200.201.202.1

Address:        200.201.202.1#53

Name:   tankhoi02.edu.vn

Address: 200.201.202.2

## 12.2.2. L ệ nh host

## #host tankhoi01.dng.vn

tankhoi01.dng.vn has address 200.201.202.1

## 12.2.3. L ệ nh dig

## # dig dng.vn

; &lt;&lt;&gt;&gt; DiG 9.2.1 &lt;&lt;&gt;&gt; dng.vn

;; global options:  printcmd

;; Got answer:

;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 58922

;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0

;; QUESTION SECTION:

;dng.vn.                                IN      A

;; AUTHORITY SECTION:

dng.vn.                 86400   IN      SOA     dng. root.localhost.dng.vn. 1 28800 7200 604800 86400

;; Query time: 28 msec

;; SERVER: 200.201.202.1#53(200.201.202.1)

;; WHEN: Mon Mar 22 09:14:13 2004

;; MSG SIZE  rcvd: 78

## 12.2.4. Ti Ӌ n ích redhat-config-bind

## #redhat-config-bind

Hình 2. C ấ u hình d ị ch v ụ BIND b ằ ng ti ệ n ích redhat-config-bind.

<!-- image -->

<!-- image -->

## @2004,  Nguy ễ n T ấ n Khôi

Khoa CNTT Tr

ườ

ng

Đạ

i h c Bách Khoa

ọ

Đ

à N

ẵ

ng